<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>simdna.synthetic &mdash; SimDNA 0.0.1 documentation</title>
    
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="top" title="SimDNA 0.0.1 documentation" href="../../index.html" />
    <link rel="up" title="Module code" href="../index.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for simdna.synthetic</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">absolute_import</span><span class="p">,</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="k">import</span> <span class="n">util</span><span class="p">,</span> <span class="n">pwm</span><span class="p">,</span> <span class="n">fileProcessing</span> <span class="k">as</span> <span class="n">fp</span>
<span class="kn">import</span> <span class="nn">argparse</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="k">import</span> <span class="n">OrderedDict</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">re</span>


<div class="viewcode-block" id="LabelGenerator"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.LabelGenerator">[docs]</a><span class="k">class</span> <span class="nc">LabelGenerator</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Generate labels for a generated sequence.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        labelNames: an array of strings that are the names of the labels</span>
<span class="sd">        labelsFromGeneratedSequenceFunction: function that accepts</span>
<span class="sd">            an instance of :class:`.GeneratedSequence` and returns an array</span>
<span class="sd">            of the labels (eg: an array of ones and zeros indicating if</span>
<span class="sd">            the criteria for various labels are met)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">labelNames</span><span class="p">,</span> <span class="n">labelsFromGeneratedSequenceFunction</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">labelNames</span> <span class="o">=</span> <span class="n">labelNames</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">labelsFromGeneratedSequenceFunction</span> <span class="o">=</span> <span class="n">labelsFromGeneratedSequenceFunction</span>

<div class="viewcode-block" id="LabelGenerator.generateLabels"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.LabelGenerator.generateLabels">[docs]</a>    <span class="k">def</span> <span class="nf">generateLabels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">generatedSequence</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;calls self.labelsFromGeneratedSequenceFunction.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            generatedSequence: an instance of :class:`.GeneratedSequence`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">labelsFromGeneratedSequenceFunction</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">generatedSequence</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="IsInTraceLabelGenerator"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.IsInTraceLabelGenerator">[docs]</a><span class="k">class</span> <span class="nc">IsInTraceLabelGenerator</span><span class="p">(</span><span class="n">LabelGenerator</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;LabelGenerator where labels match which embedders are called.</span>

<span class="sd">    A special kind of LabelGenerator where the names of the labels</span>
<span class="sd">        are the names of embedders, and the label is 1 if a particular</span>
<span class="sd">        embedder has been called on the sequence and 0 otherwise.</span>
<span class="sd">    &quot;&quot;&quot;</span> 
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">labelNames</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">labelsFromGeneratedSequenceFunction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">generatedSequence</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">[(</span><span class="mi">1</span> <span class="k">if</span> <span class="n">generatedSequence</span><span class="o">.</span><span class="n">additionalInfo</span><span class="o">.</span><span class="n">isInTrace</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">labelNames</span><span class="p">]</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">IsInTraceLabelGenerator</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span>
            <span class="n">labelNames</span><span class="p">,</span> <span class="n">labelsFromGeneratedSequenceFunction</span><span class="p">)</span></div>


<div class="viewcode-block" id="printSequences"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.printSequences">[docs]</a><span class="k">def</span> <span class="nf">printSequences</span><span class="p">(</span><span class="n">outputFileName</span><span class="p">,</span> <span class="n">sequenceSetGenerator</span><span class="p">,</span>
                   <span class="n">includeEmbeddings</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">labelGenerator</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                   <span class="n">includeFasta</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Print a series of synthetic sequences.</span>

<span class="sd">    Given an output filename, and an instance of</span>
<span class="sd">        :class:`.AbstractSequenceSetGenerator`, will call the</span>
<span class="sd">        sequenceSetGenerator and print the generated sequences</span>
<span class="sd">        to the output file. Will also create a file &quot;info_outputFileName.txt&quot;</span>
<span class="sd">        in the same directory as outputFileName that contains</span>
<span class="sd">        all the information about sequenceSetGenerator.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        outputFileName: string</span>

<span class="sd">        sequenceSetGenerator: instance of</span>
<span class="sd">            :class:`.AbstractSequenceSetGenerator`</span>
<span class="sd">    </span>
<span class="sd">        includeEmbeddings: a boolean indicating whether to print a</span>
<span class="sd">            column that lists the embeddings</span>
<span class="sd">    </span>
<span class="sd">        labelGenerator: optional instance of :class:`.LabelGenerator`</span>

<span class="sd">        includeFasta: optional boolean indicating whether to also</span>
<span class="sd">            print out the generated sequences in fasta format</span>
<span class="sd">            (the file will be produced with a .fa extension)</span>

<span class="sd">        prefix: string - this will be prefixed in front of the generated</span>
<span class="sd">            sequence ids, followed by a hyphen</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ofh</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">getFileHandle</span><span class="p">(</span><span class="n">outputFileName</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">includeFasta</span><span class="p">):</span>
        <span class="n">fastaOfh</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">getFileHandle</span><span class="p">(</span><span class="n">fp</span><span class="o">.</span><span class="n">getFileNameParts</span><span class="p">(</span>
            <span class="n">outputFileName</span><span class="p">)</span><span class="o">.</span><span class="n">getFilePathWithTransformation</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">,</span> <span class="n">extension</span><span class="o">=</span><span class="s2">&quot;.fa&quot;</span><span class="p">),</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
    <span class="n">ofh</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;seqName</span><span class="se">\t</span><span class="s2">sequence&quot;</span>
              <span class="o">+</span> <span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">embeddings&quot;</span> <span class="k">if</span> <span class="n">includeEmbeddings</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
              <span class="o">+</span> <span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span> <span class="o">+</span>
                 <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">labelGenerator</span><span class="o">.</span><span class="n">labelNames</span><span class="p">)</span>
                 <span class="k">if</span> <span class="n">labelGenerator</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">generatedSequences</span> <span class="o">=</span> <span class="n">sequenceSetGenerator</span><span class="o">.</span><span class="n">generateSequences</span><span class="p">()</span>  <span class="c1"># returns a generator</span>
    <span class="k">for</span> <span class="n">generatedSequence</span> <span class="ow">in</span> <span class="n">generatedSequences</span><span class="p">:</span>
        <span class="n">ofh</span><span class="o">.</span><span class="n">write</span><span class="p">((</span><span class="n">prefix</span><span class="o">+</span><span class="s2">&quot;-&quot;</span> <span class="k">if</span> <span class="n">prefix</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                  <span class="o">+</span> <span class="n">generatedSequence</span><span class="o">.</span><span class="n">seqName</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">generatedSequence</span><span class="o">.</span><span class="n">seq</span>
                  <span class="o">+</span> <span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
                     <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">generatedSequence</span><span class="o">.</span><span class="n">embeddings</span><span class="p">)</span>
                         <span class="k">if</span> <span class="n">includeEmbeddings</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                  <span class="o">+</span> <span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">labelGenerator</span><span class="o">.</span><span class="n">generateLabels</span><span class="p">(</span>
                      <span class="n">generatedSequence</span><span class="p">))</span> <span class="k">if</span> <span class="n">labelGenerator</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                  <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">includeFasta</span><span class="p">):</span>
            <span class="n">fastaOfh</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&gt;&quot;</span> <span class="o">+</span> <span class="p">(</span><span class="n">prefix</span><span class="o">+</span><span class="s2">&quot;-&quot;</span> <span class="k">if</span> <span class="n">prefix</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                               <span class="o">+</span> <span class="n">generatedSequence</span><span class="o">.</span><span class="n">seqName</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">fastaOfh</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">generatedSequence</span><span class="o">.</span><span class="n">seq</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">ofh</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">includeFasta</span><span class="p">):</span>
        <span class="n">fastaOfh</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="n">infoFilePath</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">getFileNameParts</span><span class="p">(</span><span class="n">outputFileName</span><span class="p">)</span><span class="o">.</span><span class="n">getFilePathWithTransformation</span><span class="p">(</span>
        <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">+</span> <span class="s2">&quot;_info&quot;</span><span class="p">,</span> <span class="n">extension</span><span class="o">=</span><span class="s2">&quot;.txt&quot;</span><span class="p">)</span>

    <span class="n">ofh</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">getFileHandle</span><span class="p">(</span><span class="n">infoFilePath</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
    <span class="n">ofh</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">util</span><span class="o">.</span><span class="n">formattedJsonDump</span><span class="p">(</span><span class="n">sequenceSetGenerator</span><span class="o">.</span><span class="n">getJsonableObject</span><span class="p">()))</span>
    <span class="n">ofh</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>


<div class="viewcode-block" id="DefaultNameMixin"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.DefaultNameMixin">[docs]</a><span class="k">class</span> <span class="nc">DefaultNameMixin</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Basic functionality for classes that have a self.name attribute.</span>
<span class="sd">    </span>
<span class="sd">    The self.name attribute is typically used to leave a trace in</span>
<span class="sd">    an instance of :class:`.AdditionalInfo`</span>
<span class="sd">    </span>
<span class="sd">    Arguments:</span>
<span class="sd">        name: string</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">name</span> <span class="o">==</span> <span class="kc">None</span><span class="p">):</span>
            <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDefaultName</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>

<div class="viewcode-block" id="DefaultNameMixin.getDefaultName"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.DefaultNameMixin.getDefaultName">[docs]</a>    <span class="k">def</span> <span class="nf">getDefaultName</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;No default name implementation&quot;</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="AbstractPositionGenerator"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.AbstractPositionGenerator">[docs]</a><span class="k">class</span> <span class="nc">AbstractPositionGenerator</span><span class="p">(</span><span class="n">DefaultNameMixin</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Generate a start position at which to embed something</span>

<span class="sd">    Given the length of the background sequence and the length</span>
<span class="sd">    of the substring you are trying to embed, will return a start position</span>
<span class="sd">    to embed the substring at.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="AbstractPositionGenerator.generatePos"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.AbstractPositionGenerator.generatePos">[docs]</a>    <span class="k">def</span> <span class="nf">generatePos</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lenBackground</span><span class="p">,</span> <span class="n">lenSubstring</span><span class="p">,</span> <span class="n">additionalInfo</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Generate the position to embed in.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            lenBackground: int, length of background sequence</span>

<span class="sd">            lenSubstring: int, lenght of substring to embed</span>

<span class="sd">            additionalInfo: optional, instance of :class:`.AdditionalInfo`. Is</span>
<span class="sd">                used to leave a trace that this positionGenerator was called</span>

<span class="sd">        Returns:</span>
<span class="sd">            An integer which is the start index to embed in.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">additionalInfo</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
            <span class="n">additionalInfo</span><span class="o">.</span><span class="n">updateTrace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generatePos</span><span class="p">(</span><span class="n">lenBackground</span><span class="p">,</span> <span class="n">lenSubstring</span><span class="p">,</span> <span class="n">additionalInfo</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_generatePos</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lenBackground</span><span class="p">,</span> <span class="n">lenSubstring</span><span class="p">,</span> <span class="n">additionalInfo</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Generate the position to embed in - this method should be</span>
<span class="sd">        overriden by the subclass. See</span>
<span class="sd">        :func:`.AbstractPositionGenerator.generatePos` for documentaiton</span>
<span class="sd">        on the arguments.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>

<div class="viewcode-block" id="AbstractPositionGenerator.getJsonableObject"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.AbstractPositionGenerator.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get JSON object representation.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A json-friendly object (built of dictionaries, lists and</span>
<span class="sd">        python primitives), which can be converted to json to</span>
<span class="sd">        record the exact details of what was simualted.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span></div></div>


<div class="viewcode-block" id="UniformPositionGenerator"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.UniformPositionGenerator">[docs]</a><span class="k">class</span> <span class="nc">UniformPositionGenerator</span><span class="p">(</span><span class="n">AbstractPositionGenerator</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Sample position uniformly at random.</span>
<span class="sd">    </span>
<span class="sd">    Samples a start position to embed the substring in uniformly at random;</span>
<span class="sd">        does not return positions that are too close to the end of the</span>
<span class="sd">        background sequence to embed the full substring.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        name: string, see :class:`.DefaultNameMixin`</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">UniformPositionGenerator</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_generatePos</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lenBackground</span><span class="p">,</span> <span class="n">lenSubstring</span><span class="p">,</span> <span class="n">additionalInfo</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">sampleIndexWithinRegionOfLength</span><span class="p">(</span><span class="n">lenBackground</span><span class="p">,</span> <span class="n">lenSubstring</span><span class="p">)</span>

<div class="viewcode-block" id="UniformPositionGenerator.getJsonableObject"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.UniformPositionGenerator.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See superclass.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s2">&quot;uniform&quot;</span></div></div>

<span class="c1">#instantiate a UniformPositionGenerator for general use</span>
<span class="n">uniformPositionGenerator</span> <span class="o">=</span> <span class="n">UniformPositionGenerator</span><span class="p">()</span>


<div class="viewcode-block" id="InsideCentralBp"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.InsideCentralBp">[docs]</a><span class="k">class</span> <span class="nc">InsideCentralBp</span><span class="p">(</span><span class="n">AbstractPositionGenerator</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;For embedding within only the central region of a background.</span>
<span class="sd">        </span>
<span class="sd">    Returns a position within the central region of a background</span>
<span class="sd">        sequence, sampled uniformly at random</span>

<span class="sd">    Arguments:</span>
<span class="sd">        centralBp: int, the number of bp, centered in the</span>
<span class="sd">            middle of the background, from which to sample the position.</span>
<span class="sd">            Is NOT +/- centralBp around the middle</span>
<span class="sd">            (is +/- centralBp/2 around the middle). If the background</span>
<span class="sd">            sequence is even and centralBp is odd, the shorter region</span>
<span class="sd">            will go on the left.</span>
<span class="sd">        name: string - see :class:`.DefaultNameMixin`</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">centralBp</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">centralBp</span> <span class="o">=</span> <span class="n">centralBp</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">InsideCentralBp</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_generatePos</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lenBackground</span><span class="p">,</span> <span class="n">lenSubstring</span><span class="p">,</span> <span class="n">additionalInfo</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">lenBackground</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">centralBp</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;The background length should be atleast as long as self.centralBp; is &quot;</span> <span class="o">+</span>
                               <span class="nb">str</span><span class="p">(</span><span class="n">lenBackground</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; and &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">centralBp</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; respectively&quot;</span><span class="p">)</span>
        <span class="n">startIndexForRegionToEmbedIn</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span>
            <span class="n">lenBackground</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">centralBp</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">indexToSample</span> <span class="o">=</span> <span class="n">startIndexForRegionToEmbedIn</span> <span class="o">+</span> \
            <span class="n">sampleIndexWithinRegionOfLength</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">centralBp</span><span class="p">,</span> <span class="n">lenSubstring</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">indexToSample</span><span class="p">)</span>

<div class="viewcode-block" id="InsideCentralBp.getJsonableObject"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.InsideCentralBp.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See superclass.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s2">&quot;insideCentral-&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">centralBp</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="OutsideCentralBp"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.OutsideCentralBp">[docs]</a><span class="k">class</span> <span class="nc">OutsideCentralBp</span><span class="p">(</span><span class="n">AbstractPositionGenerator</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;For embedding only OUTSIDE a central region of a background seq.</span>

<span class="sd">    Returns a position OUTSIDE the central region of a background sequence,</span>
<span class="sd">        sampled uniformly at random. Complement of InsideCentralBp.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        centralBp: int, the centralBp to avoid embedding in. See the docs</span>
<span class="sd">            for :class:`.InsideCentralBp` for more details (this is the</span>
<span class="sd">            complement).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">centralBp</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">centralBp</span> <span class="o">=</span> <span class="n">centralBp</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">OutsideCentralBp</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_generatePos</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lenBackground</span><span class="p">,</span> <span class="n">lenSubstring</span><span class="p">,</span> <span class="n">additionalInfo</span><span class="p">):</span>
        <span class="c1"># choose whether to embed in the left or the right</span>
        <span class="k">if</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">:</span>
            <span class="n">left</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">left</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="c1"># embeddableLength is the length of the region we are considering</span>
        <span class="c1"># embedding in</span>
        <span class="n">embeddableLength</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">lenBackground</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">centralBp</span><span class="p">)</span>
        <span class="c1"># if lenBackground-self.centralBp is odd, the longer region</span>
        <span class="c1"># goes on the left (inverse of the shorter embeddable region going on the left in</span>
        <span class="c1"># the centralBpToEmbedIn case</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">left</span><span class="p">):</span>
            <span class="n">embeddableLength</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">embeddableLength</span><span class="p">)</span>
            <span class="n">startIndexForRegionToEmbedIn</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">embeddableLength</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">embeddableLength</span><span class="p">)</span>
            <span class="n">startIndexForRegionToEmbedIn</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span>
                <span class="p">(</span><span class="n">lenBackground</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">centralBp</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">centralBp</span>
        <span class="n">indexToSample</span> <span class="o">=</span> <span class="n">startIndexForRegionToEmbedIn</span> <span class="o">+</span> \
            <span class="n">sampleIndexWithinRegionOfLength</span><span class="p">(</span><span class="n">embeddableLength</span><span class="p">,</span> <span class="n">lenSubstring</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">indexToSample</span><span class="p">)</span>

<div class="viewcode-block" id="OutsideCentralBp.getJsonableObject"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.OutsideCentralBp.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See superclass.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s2">&quot;outsideCentral-&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">centralBp</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="GeneratedSequence"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.GeneratedSequence">[docs]</a><span class="k">class</span> <span class="nc">GeneratedSequence</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;An object representing a sequence that has been generated.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        seqName: string representing the name/id of the sequence</span>

<span class="sd">        seq: string representing the final generated sequence</span>

<span class="sd">        embeddings: an array of :class:`.Embedding` objects.</span>

<span class="sd">        additionalInfo: an instance of :class:`.AdditionalInfo`</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seqName</span><span class="p">,</span> <span class="n">seq</span><span class="p">,</span> <span class="n">embeddings</span><span class="p">,</span> <span class="n">additionalInfo</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">seqName</span> <span class="o">=</span> <span class="n">seqName</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">seq</span> <span class="o">=</span> <span class="n">seq</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">embeddings</span> <span class="o">=</span> <span class="n">embeddings</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">additionalInfo</span> <span class="o">=</span> <span class="n">additionalInfo</span></div>


<div class="viewcode-block" id="Embedding"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.Embedding">[docs]</a><span class="k">class</span> <span class="nc">Embedding</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Represents something that has been embedded in a sequence.</span>

<span class="sd">    Think of this as a combination of an embeddable + a start position.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        what: object representing the thing that has been embedded.\</span>
<span class="sd">            Should have`` __str__`` and ``__len__`` defined.\</span>
<span class="sd">            Often is an instance of :class:`.AbstractEmbeddable`</span>

<span class="sd">        startPos: int, the position relative to the start of the parent\</span>
<span class="sd">            sequence at which seq has been embedded</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">what</span><span class="p">,</span> <span class="n">startPos</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">what</span> <span class="o">=</span> <span class="n">what</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">startPos</span> <span class="o">=</span> <span class="n">startPos</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;pos-&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">startPos</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">what</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
<div class="viewcode-block" id="Embedding.fromString"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.Embedding.fromString">[docs]</a>    <span class="k">def</span> <span class="nf">fromString</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">string</span><span class="p">,</span> <span class="n">whatClass</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Recreate an :class:`.Embedding` object from a string.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            string: assumed to have format:\</span>
<span class="sd">                ``description[-|_]startPos[-|_]whatString``, where</span>
<span class="sd">                ``whatString`` will be provided to ``whatClass``</span>

<span class="sd">            whatClass: the class (usually a :class:`.AbstractEmbeddable`) that\</span>
<span class="sd">                will be used to instantiate the what from the whatString</span>

<span class="sd">        Returns:</span>
<span class="sd">            The Embedding class called with</span>
<span class="sd">            ``what=whatClass.fromString(whatString)`` and</span>
<span class="sd">            ``startPos=int(startPos)``</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">whatClass</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
            <span class="n">whatClass</span> <span class="o">=</span> <span class="n">StringEmbeddable</span>
        <span class="c1"># was printed out as pos-[startPos]_[what], but the</span>
        <span class="c1">#[what] may contain underscores, hence the maxsplit</span>
        <span class="c1"># to avoid splitting on them.</span>
        <span class="n">prefix</span><span class="p">,</span> <span class="n">startPos</span><span class="p">,</span> <span class="n">whatString</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-|_&quot;</span><span class="p">,</span> <span class="n">string</span><span class="p">,</span> <span class="n">maxsplit</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">cls</span><span class="p">(</span><span class="n">what</span><span class="o">=</span><span class="n">whatClass</span><span class="o">.</span><span class="n">fromString</span><span class="p">(</span><span class="n">whatString</span><span class="p">),</span>
                   <span class="n">startPos</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">startPos</span><span class="p">))</span></div></div>


<div class="viewcode-block" id="getEmbeddingsFromString"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.getEmbeddingsFromString">[docs]</a><span class="k">def</span> <span class="nf">getEmbeddingsFromString</span><span class="p">(</span><span class="n">string</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get a series of :class:`.Embedding` objects from a string.</span>
<span class="sd">    </span>
<span class="sd">    Splits the string on commas, and then passes the comma-separated vals</span>
<span class="sd">        to :func:`.Embedding.fromString`</span>

<span class="sd">    Arguments:</span>
<span class="sd">        string: The string to turn into an array of Embedding objects</span>

<span class="sd">    Returns:</span>
<span class="sd">        an array of :class:`.Embedding` objects</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">string</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">embeddingStrings</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">Embedding</span><span class="o">.</span><span class="n">fromString</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">embeddingStrings</span><span class="p">]</span></div>


<div class="viewcode-block" id="AbstractSequenceSetGenerator"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.AbstractSequenceSetGenerator">[docs]</a><span class="k">class</span> <span class="nc">AbstractSequenceSetGenerator</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A generator for a collection of generated sequences.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="AbstractSequenceSetGenerator.generateSequences"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.AbstractSequenceSetGenerator.generateSequences">[docs]</a>    <span class="k">def</span> <span class="nf">generateSequences</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The generator; implementation should have a yield.</span>

<span class="sd">        Called as</span>
<span class="sd">        ``generatedSequences = sequenceSetGenerator.generateSequences()``</span>

<span class="sd">        ``generateSequences`` can then be iterated over.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A generator of GeneratedSequence objects</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span></div>

<div class="viewcode-block" id="AbstractSequenceSetGenerator.getJsonableObject"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.AbstractSequenceSetGenerator.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get JSON object representation.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A json-friendly object (built of dictionaries, lists and</span>
<span class="sd">        python primitives), which can be converted to json to</span>
<span class="sd">        record the exact details of what was simualted.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span></div></div>


<div class="viewcode-block" id="GenerateSequenceNTimes"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.GenerateSequenceNTimes">[docs]</a><span class="k">class</span> <span class="nc">GenerateSequenceNTimes</span><span class="p">(</span><span class="n">AbstractSequenceSetGenerator</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Call a :class:`.AbstractSingleSequenceGenerator` N times.</span>
<span class="sd">            </span>
<span class="sd">    Arguments:</span>
<span class="sd">        singleSetGenerator: an instance of</span>
<span class="sd">            :class:`.AbstractSequenceSetGenerator`</span>
<span class="sd">        N: integer, the number of times to call singleSetGenerator</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">singleSetGenerator</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">singleSetGenerator</span> <span class="o">=</span> <span class="n">singleSetGenerator</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">N</span> <span class="o">=</span> <span class="n">N</span>

<div class="viewcode-block" id="GenerateSequenceNTimes.generateSequences"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.GenerateSequenceNTimes.generateSequences">[docs]</a>    <span class="k">def</span> <span class="nf">generateSequences</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;A generator that calls self.singleSetGenerator N times.</span>

<span class="sd">        Returns:</span>
<span class="sd">            a generator that will call self.singleSetGenerator N times. </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="p">):</span>
            <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">singleSetGenerator</span><span class="o">.</span><span class="n">generateSequence</span><span class="p">()</span></div>

<div class="viewcode-block" id="GenerateSequenceNTimes.getJsonableObject"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.GenerateSequenceNTimes.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See superclass.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">OrderedDict</span><span class="p">([(</span><span class="s2">&quot;numSeq&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;singleSetGenerator&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">singleSetGenerator</span><span class="o">.</span><span class="n">getJsonableObject</span><span class="p">())])</span></div></div>


<div class="viewcode-block" id="AbstractSingleSequenceGenerator"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.AbstractSingleSequenceGenerator">[docs]</a><span class="k">class</span> <span class="nc">AbstractSingleSequenceGenerator</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Generate a single sequence.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        namePrefix: the GeneratedSequence object has a field</span>
<span class="sd">            for the object&#39;s name; this is the prefix associated</span>
<span class="sd">            with that name. The suffix is the value of a counter that</span>
<span class="sd">            is incremented every time</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">namePrefix</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">namePrefix</span> <span class="o">=</span> <span class="n">namePrefix</span> <span class="k">if</span> <span class="n">namePrefix</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s2">&quot;synth&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sequenceCounter</span> <span class="o">=</span> <span class="mi">0</span>

<div class="viewcode-block" id="AbstractSingleSequenceGenerator.generateSequence"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.AbstractSingleSequenceGenerator.generateSequence">[docs]</a>    <span class="k">def</span> <span class="nf">generateSequence</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Generate the sequence.</span>

<span class="sd">        Returns:</span>
<span class="sd">            An instance of :class:`.GeneratedSequence`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span></div>

<div class="viewcode-block" id="AbstractSingleSequenceGenerator.getJsonableObject"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.AbstractSingleSequenceGenerator.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get JSON object representation.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A json-friendly object (built of dictionaries, lists and</span>
<span class="sd">        python primitives), which can be converted to json to</span>
<span class="sd">        record the exact details of what was simualted.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span></div></div>


<div class="viewcode-block" id="AdditionalInfo"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.AdditionalInfo">[docs]</a><span class="k">class</span> <span class="nc">AdditionalInfo</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Used to keep track of which embedders/ops were</span>
<span class="sd">    called and how many times.</span>

<span class="sd">    An instance of AdditionalInfo is meant to be an attribute of</span>
<span class="sd">        a :class:`.GeneratedSequence` object. It keeps track of things</span>
<span class="sd">        like embedders, position generators, etc.</span>

<span class="sd">    Has self.trace which is a dictionary from operatorName-&gt;int</span>
<span class="sd">        and which records operations that were called in the</span>
<span class="sd">        process of embedding things in the sequence. At the time</span>
<span class="sd">        of writing, operatorName is typically just the name of the</span>
<span class="sd">        embedder.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trace</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>  <span class="c1"># a trace of everything that was called.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">additionalInfo</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>  <span class="c1"># for more ad-hoc messages</span>

<div class="viewcode-block" id="AdditionalInfo.isInTrace"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.AdditionalInfo.isInTrace">[docs]</a>    <span class="k">def</span> <span class="nf">isInTrace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">operatorName</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return True if operatorName has been called on the sequence.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">operatorName</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">trace</span></div>

<div class="viewcode-block" id="AdditionalInfo.updateTrace"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.AdditionalInfo.updateTrace">[docs]</a>    <span class="k">def</span> <span class="nf">updateTrace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">operatorName</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Increment count for the number of times operatorName was called.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">operatorName</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">trace</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">trace</span><span class="p">[</span><span class="n">operatorName</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trace</span><span class="p">[</span><span class="n">operatorName</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span></div>

<div class="viewcode-block" id="AdditionalInfo.updateAdditionalInfo"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.AdditionalInfo.updateAdditionalInfo">[docs]</a>    <span class="k">def</span> <span class="nf">updateAdditionalInfo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">operatorName</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Can be used to store any additional information on operatorName.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">additionaInfo</span><span class="p">[</span><span class="n">operatorName</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span></div></div>


<div class="viewcode-block" id="EmbedInABackground"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.EmbedInABackground">[docs]</a><span class="k">class</span> <span class="nc">EmbedInABackground</span><span class="p">(</span><span class="n">AbstractSingleSequenceGenerator</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Generate a background sequence and embed smaller sequences in it.</span>
<span class="sd">    </span>
<span class="sd">    Takes a backgroundGenerator and a series of embedders. Will</span>
<span class="sd">    generate the background and then call each of the embedders in</span>
<span class="sd">    succession. Then returns the result.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        backgroundGenerator: instance of</span>
<span class="sd">            :class:`.AbstractBackgroundGenerator`</span>
<span class="sd">        embedders: array of instances of :class:`.AbstractEmbedder`</span>
<span class="sd">        namePrefix: see parent</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">backgroundGenerator</span><span class="p">,</span> <span class="n">embedders</span><span class="p">,</span> <span class="n">namePrefix</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">EmbedInABackground</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">namePrefix</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">backgroundGenerator</span> <span class="o">=</span> <span class="n">backgroundGenerator</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">embedders</span> <span class="o">=</span> <span class="n">embedders</span>

<div class="viewcode-block" id="EmbedInABackground.generateSequence"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.EmbedInABackground.generateSequence">[docs]</a>    <span class="k">def</span> <span class="nf">generateSequence</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Produce the sequence.</span>
<span class="sd">        </span>
<span class="sd">        Generates a background using self.backgroundGenerator,</span>
<span class="sd">        splits it into an array, and passes it to each of</span>
<span class="sd">        self.embedders in turn for embedding things.</span>

<span class="sd">        Returns:</span>
<span class="sd">            An instance of :class:`.GeneratedSequence`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">additionalInfo</span> <span class="o">=</span> <span class="n">AdditionalInfo</span><span class="p">()</span>
        <span class="n">backgroundString</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">backgroundGenerator</span><span class="o">.</span><span class="n">generateBackground</span><span class="p">()</span>
        <span class="n">backgroundStringArr</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">backgroundString</span><span class="p">]</span>
        <span class="c1"># priorEmbeddedThings keeps track of what has already been embedded</span>
        <span class="n">priorEmbeddedThings</span> <span class="o">=</span> <span class="n">PriorEmbeddedThings_numpyArrayBacked</span><span class="p">(</span>
            <span class="nb">len</span><span class="p">(</span><span class="n">backgroundStringArr</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">embedder</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">embedders</span><span class="p">:</span>
            <span class="n">embedder</span><span class="o">.</span><span class="n">embed</span><span class="p">(</span><span class="n">backgroundStringArr</span><span class="p">,</span>
                           <span class="n">priorEmbeddedThings</span><span class="p">,</span> <span class="n">additionalInfo</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sequenceCounter</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">GeneratedSequence</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">namePrefix</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sequenceCounter</span><span class="p">),</span>
                                 <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">backgroundStringArr</span><span class="p">),</span>
                                 <span class="n">priorEmbeddedThings</span><span class="o">.</span><span class="n">getEmbeddings</span><span class="p">(),</span>
                                 <span class="n">additionalInfo</span><span class="p">)</span></div>

<div class="viewcode-block" id="EmbedInABackground.getJsonableObject"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.EmbedInABackground.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See superclass.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">OrderedDict</span><span class="p">([(</span><span class="s2">&quot;class&quot;</span><span class="p">,</span> <span class="s2">&quot;EmbedInABackground&quot;</span><span class="p">),</span>
                            <span class="p">(</span><span class="s2">&quot;namePrefix&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">namePrefix</span><span class="p">),</span>
                            <span class="p">(</span><span class="s2">&quot;backgroundGenerator&quot;</span><span class="p">,</span>
                             <span class="bp">self</span><span class="o">.</span><span class="n">backgroundGenerator</span><span class="o">.</span><span class="n">getJsonableObject</span><span class="p">()),</span>
                            <span class="p">(</span><span class="s2">&quot;embedders&quot;</span><span class="p">,</span>
                             <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">getJsonableObject</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">embedders</span><span class="p">])</span>
                            <span class="p">])</span></div></div>


<div class="viewcode-block" id="AbstractPriorEmbeddedThings"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.AbstractPriorEmbeddedThings">[docs]</a><span class="k">class</span> <span class="nc">AbstractPriorEmbeddedThings</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Keeps track of what has already been embedded in a sequence.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="AbstractPriorEmbeddedThings.canEmbed"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.AbstractPriorEmbeddedThings.canEmbed">[docs]</a>    <span class="k">def</span> <span class="nf">canEmbed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">startPos</span><span class="p">,</span> <span class="n">endPos</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Test whether startPos-endPos is available for embedding.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            startPos: int, starting index</span>
<span class="sd">            endPos: int, ending index+1 (same semantics as array-slicing)</span>

<span class="sd">        Returns:</span>
<span class="sd">            True if startPos:endPos is available for embedding</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span></div>

<div class="viewcode-block" id="AbstractPriorEmbeddedThings.addEmbedding"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.AbstractPriorEmbeddedThings.addEmbedding">[docs]</a>    <span class="k">def</span> <span class="nf">addEmbedding</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">startPos</span><span class="p">,</span> <span class="n">what</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Records the embedding of a :class:`AbstractEmbeddable`.</span>

<span class="sd">        Embeds ``what`` from ``startPos`` to ``startPos+len(what)``.</span>
<span class="sd">        Creates an :class:`Embedding` object.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            startPos: int, the starting position at which to embed.</span>
<span class="sd">            what: instance of :class:`AbstractEmbeddable`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span></div>

<div class="viewcode-block" id="AbstractPriorEmbeddedThings.getNumOccupiedPos"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.AbstractPriorEmbeddedThings.getNumOccupiedPos">[docs]</a>    <span class="k">def</span> <span class="nf">getNumOccupiedPos</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns:</span>
<span class="sd">            Number of posiitons that are filled with some kind of embedding</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span></div>

<div class="viewcode-block" id="AbstractPriorEmbeddedThings.getTotalPos"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.AbstractPriorEmbeddedThings.getTotalPos">[docs]</a>    <span class="k">def</span> <span class="nf">getTotalPos</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns:</span>
<span class="sd">            Total number of positions (occupied and unoccupoed) available</span>
<span class="sd">        to embed things in.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span></div>

<div class="viewcode-block" id="AbstractPriorEmbeddedThings.getEmbeddings"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.AbstractPriorEmbeddedThings.getEmbeddings">[docs]</a>    <span class="k">def</span> <span class="nf">getEmbeddings</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns:</span>
<span class="sd">            A collection of Embedding objects</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span></div></div>


<div class="viewcode-block" id="PriorEmbeddedThings_numpyArrayBacked"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.PriorEmbeddedThings_numpyArrayBacked">[docs]</a><span class="k">class</span> <span class="nc">PriorEmbeddedThings_numpyArrayBacked</span><span class="p">(</span><span class="n">AbstractPriorEmbeddedThings</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A numpy-array based implementation of</span>
<span class="sd">    :class:`.AbstractPriorEmbeddedThings`.</span>

<span class="sd">    Uses a numpy array where positions are set to 1 if they are occupied,</span>
<span class="sd">    to determine which positions are occupied and which are not.</span>
<span class="sd">    See superclass for more documentation.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        seqLen: integer indicating length of the sequence you are embedding in</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seqLen</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">seqLen</span> <span class="o">=</span> <span class="n">seqLen</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">seqLen</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">embeddings</span> <span class="o">=</span> <span class="p">[]</span>

<div class="viewcode-block" id="PriorEmbeddedThings_numpyArrayBacked.canEmbed"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.PriorEmbeddedThings_numpyArrayBacked.canEmbed">[docs]</a>    <span class="k">def</span> <span class="nf">canEmbed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">startPos</span><span class="p">,</span> <span class="n">endPos</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See superclass.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">arr</span><span class="p">[</span><span class="n">startPos</span><span class="p">:</span><span class="n">endPos</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span></div>

<div class="viewcode-block" id="PriorEmbeddedThings_numpyArrayBacked.addEmbedding"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.PriorEmbeddedThings_numpyArrayBacked.addEmbedding">[docs]</a>    <span class="k">def</span> <span class="nf">addEmbedding</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">startPos</span><span class="p">,</span> <span class="n">what</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See superclass.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">arr</span><span class="p">[</span><span class="n">startPos</span><span class="p">:</span><span class="n">startPos</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">what</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">embeddings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Embedding</span><span class="p">(</span><span class="n">what</span><span class="o">=</span><span class="n">what</span><span class="p">,</span> <span class="n">startPos</span><span class="o">=</span><span class="n">startPos</span><span class="p">))</span></div>

<div class="viewcode-block" id="PriorEmbeddedThings_numpyArrayBacked.getNumOccupiedPos"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.PriorEmbeddedThings_numpyArrayBacked.getNumOccupiedPos">[docs]</a>    <span class="k">def</span> <span class="nf">getNumOccupiedPos</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See superclass.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">arr</span><span class="p">)</span></div>

<div class="viewcode-block" id="PriorEmbeddedThings_numpyArrayBacked.getTotalPos"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.PriorEmbeddedThings_numpyArrayBacked.getTotalPos">[docs]</a>    <span class="k">def</span> <span class="nf">getTotalPos</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See superclass.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">arr</span><span class="p">)</span></div>

<div class="viewcode-block" id="PriorEmbeddedThings_numpyArrayBacked.getEmbeddings"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.PriorEmbeddedThings_numpyArrayBacked.getEmbeddings">[docs]</a>    <span class="k">def</span> <span class="nf">getEmbeddings</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See superclass.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">embeddings</span></div></div>


<div class="viewcode-block" id="AbstractEmbeddable"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.AbstractEmbeddable">[docs]</a><span class="k">class</span> <span class="nc">AbstractEmbeddable</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Represents a thing which can be embedded.</span>

<span class="sd">        An :class:`.AbstractEmbeddable` + a position = an :class:`.Embedding`</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>

<div class="viewcode-block" id="AbstractEmbeddable.getDescription"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.AbstractEmbeddable.getDescription">[docs]</a>    <span class="k">def</span> <span class="nf">getDescription</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a concise description of the embeddable.</span>

<span class="sd">        This should be concise and shouldn&#39;t contain spaces. It will often</span>
<span class="sd">        be used when generating the __str__ representation of the embedabled.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span></div>

<div class="viewcode-block" id="AbstractEmbeddable.canEmbed"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.AbstractEmbeddable.canEmbed">[docs]</a>    <span class="k">def</span> <span class="nf">canEmbed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">priorEmbeddedThings</span><span class="p">,</span> <span class="n">startPos</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Checks whether embedding is possible at a given pos.</span>

<span class="sd">        Accepts an instance of :class:`AbstractPriorEmbeddedThings` and</span>
<span class="sd">        a ``startPos``, and checks if ``startPos`` is viable given the</span>
<span class="sd">        contents of ``priorEmbeddedThings``.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            priorEmbeddedThings: instance of</span>
<span class="sd">        :class:`AbstractPriorEmbeddedThings`</span>

<span class="sd">            startPos: int; the position you are considering embedding self at</span>

<span class="sd">        Returns:</span>
<span class="sd">            A boolean indicating whether self can be embedded at startPos,</span>
<span class="sd">        given the things that have already been embedded.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span></div>

<div class="viewcode-block" id="AbstractEmbeddable.embedInBackgroundStringArr"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.AbstractEmbeddable.embedInBackgroundStringArr">[docs]</a>    <span class="k">def</span> <span class="nf">embedInBackgroundStringArr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">priorEmbeddedThings</span><span class="p">,</span> <span class="n">backgroundStringArr</span><span class="p">,</span> <span class="n">startPos</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Embed self in a background string.</span>

<span class="sd">        Will embed self at ``startPos`` in ``backgroundStringArr``,</span>
<span class="sd">        and will update ``priorEmbeddedThings`` accordingly.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            priorEmbeddedThings: instance of</span>
<span class="sd">        :class:`AbstractPriorEmbeddedThings`</span>
<span class="sd">            backgroundStringArr: an array of characters representing</span>
<span class="sd">        the background</span>
<span class="sd">            startPos: integer; the position to embed self at</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span></div>

    <span class="nd">@classmethod</span>
<div class="viewcode-block" id="AbstractEmbeddable.fromString"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.AbstractEmbeddable.fromString">[docs]</a>    <span class="k">def</span> <span class="nf">fromString</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">theString</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Generate an instance of the embeddable from the provided string.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span></div></div>


<div class="viewcode-block" id="StringEmbeddable"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.StringEmbeddable">[docs]</a><span class="k">class</span> <span class="nc">StringEmbeddable</span><span class="p">(</span><span class="n">AbstractEmbeddable</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A string that is to be embedded in a background.</span>

<span class="sd">    Represents a string (such as a sampling from a pwm) that is to</span>
<span class="sd">    be embedded in a background. See docs for superclass.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        string: the core string to be embedded</span>

<span class="sd">        stringDescription: a short descriptor prefixed before the\</span>
<span class="sd">        __str__ representation of the embeddable. Should not contain a hyphen.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">string</span><span class="p">,</span> <span class="n">stringDescription</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">string</span> <span class="o">=</span> <span class="n">string</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stringDescription</span> <span class="o">=</span> <span class="n">stringDescription</span>

    <span class="k">def</span> <span class="nf">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">string</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">stringDescription</span> <span class="o">+</span> <span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stringDescription</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">string</span>

<div class="viewcode-block" id="StringEmbeddable.getDescription"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.StringEmbeddable.getDescription">[docs]</a>    <span class="k">def</span> <span class="nf">getDescription</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See superclass.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">stringDescription</span></div>

<div class="viewcode-block" id="StringEmbeddable.canEmbed"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.StringEmbeddable.canEmbed">[docs]</a>    <span class="k">def</span> <span class="nf">canEmbed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">priorEmbeddedThings</span><span class="p">,</span> <span class="n">startPos</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See superclass.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">priorEmbeddedThings</span><span class="o">.</span><span class="n">canEmbed</span><span class="p">(</span><span class="n">startPos</span><span class="p">,</span> <span class="n">startPos</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">string</span><span class="p">))</span></div>

<div class="viewcode-block" id="StringEmbeddable.embedInBackgroundStringArr"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.StringEmbeddable.embedInBackgroundStringArr">[docs]</a>    <span class="k">def</span> <span class="nf">embedInBackgroundStringArr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">priorEmbeddedThings</span><span class="p">,</span> <span class="n">backgroundStringArr</span><span class="p">,</span> <span class="n">startPos</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See superclass.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">backgroundStringArr</span><span class="p">[</span><span class="n">startPos</span><span class="p">:</span><span class="n">startPos</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">string</span><span class="p">)]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">string</span>
        <span class="n">priorEmbeddedThings</span><span class="o">.</span><span class="n">addEmbedding</span><span class="p">(</span><span class="n">startPos</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span></div>

    <span class="nd">@classmethod</span>
<div class="viewcode-block" id="StringEmbeddable.fromString"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.StringEmbeddable.fromString">[docs]</a>    <span class="k">def</span> <span class="nf">fromString</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">theString</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Generates a StringEmbeddable from the provided string.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            theString: string of the format ``stringDescription-coreString``.\</span>
<span class="sd">        Will then return:\</span>
<span class="sd">      ``StringEmbeddable(string=coreString, stringDescription=stringDescription)``</span>

<span class="sd">        Returns:</span>
<span class="sd">            An instance of :class:`.StringEmbeddable`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="ow">in</span> <span class="n">theString</span><span class="p">):</span>
            <span class="n">stringDescription</span><span class="p">,</span> <span class="n">coreString</span> <span class="o">=</span> <span class="n">theString</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">cls</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">coreString</span><span class="p">,</span> <span class="n">stringDescription</span><span class="o">=</span><span class="n">stringDescription</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">cls</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">theString</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="PairEmbeddable_General"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.PairEmbeddable_General">[docs]</a><span class="k">class</span> <span class="nc">PairEmbeddable_General</span><span class="p">(</span><span class="n">AbstractEmbeddable</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Embed two embeddables with some separation.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        embeddable1: first embeddable to be embedded</span>

<span class="sd">        embeddable2: second embeddable to be embedded</span>

<span class="sd">        separation: int of positions separating embeddable1 and embeddable2</span>

<span class="sd">        embeddableDescription: a concise descriptive string prefixed in\</span>
<span class="sd">        front when generating a __str__ representation of the embeddable.\</span>
<span class="sd">        Should not contain a hyphen.</span>

<span class="sd">        nothingInBetween: if true, then nothing else is allowed to be\</span>
<span class="sd">        embedded in the gap between embeddable1 and embeddable2.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">embeddable1</span><span class="p">,</span> <span class="n">embeddable2</span><span class="p">,</span> <span class="n">separation</span><span class="p">,</span>
                       <span class="n">embeddableDescription</span><span class="p">,</span> <span class="n">nothingInBetween</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">embeddable1</span> <span class="o">=</span> <span class="n">embeddable1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">embeddable2</span> <span class="o">=</span> <span class="n">embeddable2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">separation</span> <span class="o">=</span> <span class="n">separation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">embeddableDescription</span> <span class="o">=</span> <span class="n">embeddableDescription</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nothingInBetween</span> <span class="o">=</span> <span class="n">nothingInBetween</span>

    <span class="k">def</span> <span class="nf">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">embeddable1</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">separation</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">embeddable2</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">embeddableDescription</span> <span class="o">+</span> <span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="k">if</span> <span class="n">embeddableDescription</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">embeddable1</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;-Gap&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">separation</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;-&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">embeddable2</span><span class="p">)</span>

<div class="viewcode-block" id="PairEmbeddable_General.getDescription"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.PairEmbeddable_General.getDescription">[docs]</a>    <span class="k">def</span> <span class="nf">getDescription</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See superclass.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">embeddableDescription</span></div>

<div class="viewcode-block" id="PairEmbeddable_General.canEmbed"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.PairEmbeddable_General.canEmbed">[docs]</a>    <span class="k">def</span> <span class="nf">canEmbed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">priorEmbeddedThings</span><span class="p">,</span> <span class="n">startPos</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See superclass.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nothingInBetween</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">priorEmbeddedThings</span><span class="o">.</span><span class="n">canEmbed</span><span class="p">(</span><span class="n">startPos</span><span class="p">,</span> <span class="n">startPos</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">priorEmbeddedThings</span><span class="o">.</span><span class="n">canEmbed</span><span class="p">(</span><span class="n">startPos</span><span class="p">,</span> <span class="n">startPos</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">embeddable1</span><span class="p">))</span>
                    <span class="ow">and</span> <span class="n">priorEmbeddedThings</span><span class="o">.</span><span class="n">canEmbed</span><span class="p">(</span><span class="n">startPos</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">embeddable1</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">separation</span><span class="p">,</span> <span class="n">startPos</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)))</span></div>

<div class="viewcode-block" id="PairEmbeddable_General.embedInBackgroundStringArr"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.PairEmbeddable_General.embedInBackgroundStringArr">[docs]</a>    <span class="k">def</span> <span class="nf">embedInBackgroundStringArr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">priorEmbeddedThings</span><span class="p">,</span>
                                         <span class="n">backgroundStringArr</span><span class="p">,</span> <span class="n">startPos</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See superclass.</span>

<span class="sd">        If ``self.nothingInBetween``, then all the intervening positions</span>
<span class="sd">        between the two embeddables will be marked as occupied. Otherwise,</span>
<span class="sd">        only the positions occupied by the embeddables will be marked</span>
<span class="sd">        as occupied.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">embeddable1</span><span class="o">.</span><span class="n">embedInBackgroundStringArr</span><span class="p">(</span>
            <span class="n">priorEmbeddedThings</span><span class="p">,</span> <span class="n">backgroundStringArr</span><span class="p">,</span> <span class="n">startPos</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">embeddable2</span><span class="o">.</span><span class="n">embedInBackgroundStringArr</span><span class="p">(</span>
            <span class="n">priorEmbeddedThings</span><span class="p">,</span> <span class="n">backgroundStringArr</span><span class="p">,</span> <span class="n">startPos</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">separation</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nothingInBetween</span><span class="p">):</span>
            <span class="n">priorEmbeddedThings</span><span class="o">.</span><span class="n">addEmbedding</span><span class="p">(</span><span class="n">startPos</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">priorEmbeddedThings</span><span class="o">.</span><span class="n">addEmbedding</span><span class="p">(</span><span class="n">startPos</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">embeddable1</span><span class="p">)</span>
            <span class="n">priorEmbeddedThings</span><span class="o">.</span><span class="n">addEmbedding</span><span class="p">(</span>
                <span class="n">startPos</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">string1</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">separation</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">embeddable2</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="PairEmbeddable"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.PairEmbeddable">[docs]</a><span class="k">class</span> <span class="nc">PairEmbeddable</span><span class="p">(</span><span class="n">AbstractEmbeddable</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Embed two strings with some separation. To be deprecated.</span>

<span class="sd">    To be deprecated in favour of PairEmbeddable_General.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        string1: first string to be embedded</span>

<span class="sd">        string2: second string to be embedded</span>

<span class="sd">        separation: int of positions separating string1 and string2</span>

<span class="sd">        embeddableDescription: a concise descriptive string prefixed in\</span>
<span class="sd">    front when generating a __str__ representation of the embeddable.\</span>
<span class="sd">    Should not contain a hyphen.</span>

<span class="sd">        nothingInBetween: if true, then nothing else is allowed to be\</span>
<span class="sd">    embedded in the gap between string1 and string2.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">string1</span><span class="p">,</span> <span class="n">string2</span><span class="p">,</span> <span class="n">separation</span><span class="p">,</span> <span class="n">embeddableDescription</span><span class="p">,</span> <span class="n">nothingInBetween</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">string1</span> <span class="o">=</span> <span class="n">string1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">string2</span> <span class="o">=</span> <span class="n">string2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">separation</span> <span class="o">=</span> <span class="n">separation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">embeddableDescription</span> <span class="o">=</span> <span class="n">embeddableDescription</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nothingInBetween</span> <span class="o">=</span> <span class="n">nothingInBetween</span>

    <span class="k">def</span> <span class="nf">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">string1</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">separation</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">string2</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">embeddableDescription</span> <span class="o">+</span> <span class="s2">&quot;-&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">string1</span> <span class="o">+</span> <span class="s2">&quot;-Gap&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">separation</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;-&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">string2</span>

<div class="viewcode-block" id="PairEmbeddable.getDescription"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.PairEmbeddable.getDescription">[docs]</a>    <span class="k">def</span> <span class="nf">getDescription</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">embeddableDescription</span></div>

<div class="viewcode-block" id="PairEmbeddable.canEmbed"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.PairEmbeddable.canEmbed">[docs]</a>    <span class="k">def</span> <span class="nf">canEmbed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">priorEmbeddedThings</span><span class="p">,</span> <span class="n">startPos</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nothingInBetween</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">priorEmbeddedThings</span><span class="o">.</span><span class="n">canEmbed</span><span class="p">(</span><span class="n">startPos</span><span class="p">,</span> <span class="n">startPos</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">priorEmbeddedThings</span><span class="o">.</span><span class="n">canEmbed</span><span class="p">(</span><span class="n">startPos</span><span class="p">,</span> <span class="n">startPos</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">string1</span><span class="p">))</span>
                    <span class="ow">and</span> <span class="n">priorEmbeddedThings</span><span class="o">.</span><span class="n">canEmbed</span><span class="p">(</span><span class="n">startPos</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">string1</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">separation</span><span class="p">,</span> <span class="n">startPos</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)))</span></div>

<div class="viewcode-block" id="PairEmbeddable.embedInBackgroundStringArr"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.PairEmbeddable.embedInBackgroundStringArr">[docs]</a>    <span class="k">def</span> <span class="nf">embedInBackgroundStringArr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">priorEmbeddedThings</span><span class="p">,</span> <span class="n">backgroundStringArr</span><span class="p">,</span> <span class="n">startPos</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See superclass.</span>

<span class="sd">        If ``self.nothingInBetween``, then all the intervening positions</span>
<span class="sd">        between the two embeddables will be marked as occupied. Otherwise,</span>
<span class="sd">        only the positions occupied by the embeddables will be marked</span>
<span class="sd">        as occupied.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">backgroundStringArr</span><span class="p">[</span><span class="n">startPos</span><span class="p">:</span><span class="n">startPos</span> <span class="o">+</span>
                            <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">string1</span><span class="p">)]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">string1</span>
        <span class="n">backgroundStringArr</span><span class="p">[</span>
            <span class="n">startPos</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">string1</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">separation</span><span class="p">:</span><span class="n">startPos</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">string2</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nothingInBetween</span><span class="p">):</span>
            <span class="n">priorEmbeddedThings</span><span class="o">.</span><span class="n">addEmbedding</span><span class="p">(</span><span class="n">startPos</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">priorEmbeddedThings</span><span class="o">.</span><span class="n">addEmbedding</span><span class="p">(</span><span class="n">startPos</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">string1</span><span class="p">)</span>
            <span class="n">priorEmbeddedThings</span><span class="o">.</span><span class="n">addEmbedding</span><span class="p">(</span>
                <span class="n">startPos</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">string1</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">separation</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">string2</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="AbstractEmbedder"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.AbstractEmbedder">[docs]</a><span class="k">class</span> <span class="nc">AbstractEmbedder</span><span class="p">(</span><span class="n">DefaultNameMixin</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Produces :class:`AbstractEmbeddable` objects and</span>
<span class="sd">    embeds them in a sequence.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="AbstractEmbedder.embed"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.AbstractEmbedder.embed">[docs]</a>    <span class="k">def</span> <span class="nf">embed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">backgroundStringArr</span><span class="p">,</span> <span class="n">priorEmbeddedThings</span><span class="p">,</span> <span class="n">additionalInfo</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Embeds things in the provided ``backgroundStringArr``.</span>

<span class="sd">        Modifies backgroundStringArr to include whatever has been embedded.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            backgroundStringArr: array of characters\</span>
<span class="sd">        representing the background string</span>

<span class="sd">            priorEmbeddedThings: instance of\</span>
<span class="sd">        :class:`.AbstractPriorEmbeddedThings`</span>

<span class="sd">            additionalInfo: instance of :class:`.AdditionalInfo`;\</span>
<span class="sd">        allows the embedder to send back info about what it did</span>

<span class="sd">        Returns:</span>
<span class="sd">            The modifed ``backgroundStringArr``</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">additionalInfo</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
            <span class="n">additionalInfo</span><span class="o">.</span><span class="n">updateTrace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_embed</span><span class="p">(</span><span class="n">backgroundStringArr</span><span class="p">,</span> <span class="n">priorEmbeddedThings</span><span class="p">,</span> <span class="n">additionalInfo</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_embed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">backgroundStringArr</span><span class="p">,</span> <span class="n">priorEmbeddedThings</span><span class="p">,</span> <span class="n">additionalInfo</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The actual implementation of _embed to be overridden by</span>
<span class="sd">        the subclass.</span>

<span class="sd">        See docs for :func:`.AbstractEmbedder.embed`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>

<div class="viewcode-block" id="AbstractEmbedder.getJsonableObject"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.AbstractEmbedder.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get JSON object representation.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A json-friendly object (built of dictionaries, lists and</span>
<span class="sd">        python primitives), which can be converted to json to</span>
<span class="sd">        record the exact details of what was simualted.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span></div></div>


<div class="viewcode-block" id="EmbeddableEmbedder"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.EmbeddableEmbedder">[docs]</a><span class="k">class</span> <span class="nc">EmbeddableEmbedder</span><span class="p">(</span><span class="n">AbstractEmbedder</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Embeds an instance of :class:`.AbstractEmbeddable` at a sampled pos.</span>

<span class="sd">    Embeds instances of :class:`.AbstractEmbeddable` within the</span>
<span class="sd">    background sequence, at a position sampled from a distribution.</span>
<span class="sd">    Only embeds at unoccupied positions.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        embeddableGenerator: instance of :class:`.AbstractEmbeddableGenerator`</span>

<span class="sd">        positionGenerator: instance of :class:`.AbstractPositionGenerator`</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">embeddableGenerator</span><span class="p">,</span>
                       <span class="n">positionGenerator</span><span class="o">=</span><span class="n">uniformPositionGenerator</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">embeddableGenerator</span> <span class="o">=</span> <span class="n">embeddableGenerator</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">positionGenerator</span> <span class="o">=</span> <span class="n">positionGenerator</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">EmbeddableEmbedder</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_embed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">backgroundStringArr</span><span class="p">,</span> <span class="n">priorEmbeddedThings</span><span class="p">,</span> <span class="n">additionalInfo</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See superclass.</span>

<span class="sd">        Calls self.embeddableGenerator to determine the</span>
<span class="sd">        embeddable to embed. Then calls self.positionGenerator to</span>
<span class="sd">        determine the start position at which to embed it.</span>
<span class="sd">        If the position is occupied, will resample from</span>
<span class="sd">        ``self.positionGenerator``. Will warn if tries to</span>
<span class="sd">        resample too many times.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">embeddable</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">embeddableGenerator</span><span class="o">.</span><span class="n">generateEmbeddable</span><span class="p">()</span>
        <span class="n">canEmbed</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">tries</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="n">canEmbed</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">tries</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">startPos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">positionGenerator</span><span class="o">.</span><span class="n">generatePos</span><span class="p">(</span>
                <span class="nb">len</span><span class="p">(</span><span class="n">backgroundStringArr</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">embeddable</span><span class="p">),</span> <span class="n">additionalInfo</span><span class="p">)</span>
            <span class="n">canEmbed</span> <span class="o">=</span> <span class="n">embeddable</span><span class="o">.</span><span class="n">canEmbed</span><span class="p">(</span><span class="n">priorEmbeddedThings</span><span class="p">,</span> <span class="n">startPos</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">tries</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Warning: made &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">tries</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; at trying to embed &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">embeddable</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; in region of length &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span>
                    <span class="n">priorEmbeddedThings</span><span class="o">.</span><span class="n">getTotalPos</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot; with &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">priorEmbeddedThings</span><span class="o">.</span><span class="n">getNumOccupiedPos</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot; occupied sites&quot;</span><span class="p">)</span>
        <span class="n">embeddable</span><span class="o">.</span><span class="n">embedInBackgroundStringArr</span><span class="p">(</span>
            <span class="n">priorEmbeddedThings</span><span class="p">,</span> <span class="n">backgroundStringArr</span><span class="p">,</span> <span class="n">startPos</span><span class="p">)</span>

<div class="viewcode-block" id="EmbeddableEmbedder.getJsonableObject"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.EmbeddableEmbedder.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See superclass.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">OrderedDict</span><span class="p">([(</span><span class="s2">&quot;embeddableGenerator&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">embeddableGenerator</span><span class="o">.</span><span class="n">getJsonableObject</span><span class="p">()),</span> <span class="p">(</span><span class="s2">&quot;positionGenerator&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">positionGenerator</span><span class="o">.</span><span class="n">getJsonableObject</span><span class="p">())])</span></div></div>


<div class="viewcode-block" id="XOREmbedder"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.XOREmbedder">[docs]</a><span class="k">class</span> <span class="nc">XOREmbedder</span><span class="p">(</span><span class="n">AbstractEmbedder</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calls exactly one of the supplied embedders.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        embedder1: instance of :class:`.AbstractEmbedder`</span>

<span class="sd">        embedder2: instance of :class:`.AbstractEmbedder`</span>

<span class="sd">        probOfFirst: probability of calling the first embedder</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">embedder1</span><span class="p">,</span> <span class="n">embedder2</span><span class="p">,</span> <span class="n">probOfFirst</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">embedder1</span> <span class="o">=</span> <span class="n">embedder1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">embedder2</span> <span class="o">=</span> <span class="n">embedder2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">probOfFirst</span> <span class="o">=</span> <span class="n">probOfFirst</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">XOREmbedder</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_embed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">backgroundStringArr</span><span class="p">,</span> <span class="n">priorEmbeddedThings</span><span class="p">,</span> <span class="n">additionalInfo</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See superclass.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">probOfFirst</span><span class="p">):</span>
            <span class="n">embedder</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">embedder1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">embedder</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">embedder2</span>
        <span class="k">return</span> <span class="n">embedder</span><span class="o">.</span><span class="n">embed</span><span class="p">(</span><span class="n">backgroundStringArr</span><span class="p">,</span> <span class="n">priorEmbeddedThings</span><span class="p">,</span> <span class="n">additionalInfo</span><span class="p">)</span>

<div class="viewcode-block" id="XOREmbedder.getJsonableObject"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.XOREmbedder.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See superclass.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">OrderedDict</span><span class="p">([(</span><span class="s2">&quot;class&quot;</span><span class="p">,</span> <span class="s2">&quot;XOREmbedder&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;embedder1&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">embedder1</span><span class="o">.</span><span class="n">getJsonableObject</span><span class="p">()),</span> <span class="p">(</span><span class="s2">&quot;embedder2&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">embedder2</span><span class="o">.</span><span class="n">getJsonableObject</span><span class="p">()),</span> <span class="p">(</span><span class="s2">&quot;probOfFirst&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">probOfFirst</span><span class="p">)])</span></div></div>


<div class="viewcode-block" id="AllEmbedders"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.AllEmbedders">[docs]</a><span class="k">class</span> <span class="nc">AllEmbedders</span><span class="p">(</span><span class="n">AbstractEmbedder</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Wrapper around a list of embedders that calls each one in turn.</span>

<span class="sd">    Useful to nest under a :class:`.RandomSubsetOfEmbedders`</span>

<span class="sd">    Arguments:</span>
<span class="sd">        embedders: an iterable of :class:`.AbstractEmbedder` objects.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">embedders</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">embedders</span> <span class="o">=</span> <span class="n">embedders</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">AllEmbedders</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_embed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">backgroundStringArr</span><span class="p">,</span> <span class="n">priorEmbeddedThings</span><span class="p">,</span> <span class="n">additionalInfo</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See superclass.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">embedder</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">embedders</span><span class="p">:</span>
            <span class="n">embedder</span><span class="o">.</span><span class="n">embed</span><span class="p">(</span><span class="n">backgroundStringArr</span><span class="p">,</span>
                           <span class="n">priorEmbeddedThings</span><span class="p">,</span> <span class="n">additionalInfo</span><span class="p">)</span>

<div class="viewcode-block" id="AllEmbedders.getJsonableObject"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.AllEmbedders.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See superclass.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">OrderedDict</span><span class="p">([(</span><span class="s2">&quot;class&quot;</span><span class="p">,</span> <span class="s2">&quot;AllEmbedders&quot;</span><span class="p">),</span>
                            <span class="p">(</span><span class="s2">&quot;embedders&quot;</span><span class="p">,</span>
                            <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">getJsonableObject</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">embedders</span><span class="p">])</span>
                           <span class="p">])</span></div></div>


<div class="viewcode-block" id="RandomSubsetOfEmbedders"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.RandomSubsetOfEmbedders">[docs]</a><span class="k">class</span> <span class="nc">RandomSubsetOfEmbedders</span><span class="p">(</span><span class="n">AbstractEmbedder</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Call some random subset of supplied embedders.</span>

<span class="sd">    Takes a quantity generator that generates a quantity of</span>
<span class="sd">    embedders, and executes that many embedders from a supplied set,</span>
<span class="sd">    in sequence</span>

<span class="sd">    Arguments:</span>
<span class="sd">        quantityGenerator: instance of :class:`.AbstractQuantityGenerator`</span>

<span class="sd">        embedders: a list of :class:`.AbstractEmbedder` objects</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">quantityGenerator</span><span class="p">,</span> <span class="n">embedders</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">quantityGenerator</span><span class="p">,</span> <span class="nb">int</span><span class="p">)):</span>
            <span class="n">quantityGenerator</span> <span class="o">=</span> <span class="n">FixedQuantityGenerator</span><span class="p">(</span><span class="n">quantityGenerator</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">quantityGenerator</span><span class="p">,</span> <span class="n">AbstractQuantityGenerator</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">quantityGenerator</span> <span class="o">=</span> <span class="n">quantityGenerator</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">embedders</span> <span class="o">=</span> <span class="n">embedders</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">RandomSubsetOfEmbedders</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_embed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">backgroundStringArr</span><span class="p">,</span> <span class="n">priorEmbeddedThings</span><span class="p">,</span> <span class="n">additionalInfo</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See superclass.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">numberOfEmbeddersToSample</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">quantityGenerator</span><span class="o">.</span><span class="n">generateQuantity</span><span class="p">()</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">numberOfEmbeddersToSample</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">embedders</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;numberOfEmbeddersToSample came up as &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span>
                <span class="n">numberOfEmbeddersToSample</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; but total number of embedders is &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">embedders</span><span class="p">)))</span>
        <span class="n">sampledEmbedders</span> <span class="o">=</span> <span class="n">util</span><span class="o">.</span><span class="n">sampleWithoutReplacement</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">embedders</span><span class="p">,</span> <span class="n">numberOfEmbeddersToSample</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">embedder</span> <span class="ow">in</span> <span class="n">sampledEmbedders</span><span class="p">:</span>
            <span class="n">embedder</span><span class="o">.</span><span class="n">embed</span><span class="p">(</span><span class="n">backgroundStringArr</span><span class="p">,</span>
                           <span class="n">priorEmbeddedThings</span><span class="p">,</span> <span class="n">additionalInfo</span><span class="p">)</span>

<div class="viewcode-block" id="RandomSubsetOfEmbedders.getJsonableObject"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.RandomSubsetOfEmbedders.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See superclass.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">OrderedDict</span><span class="p">([(</span><span class="s2">&quot;class&quot;</span><span class="p">,</span> <span class="s2">&quot;RandomSubsetOfEmbedders&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;setOfEmbedders&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">getJsonableObject</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">embedders</span><span class="p">])])</span></div></div>


<div class="viewcode-block" id="RepeatedEmbedder"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.RepeatedEmbedder">[docs]</a><span class="k">class</span> <span class="nc">RepeatedEmbedder</span><span class="p">(</span><span class="n">AbstractEmbedder</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Call an embedded multiple times.</span>

<span class="sd">    Wrapper around an embedder to call it multiple times according to samples</span>
<span class="sd">    from a distribution. First calls ``self.quantityGenerator`` to get the</span>
<span class="sd">    quantity, then calls ``self.embedder`` a number of times equal</span>
<span class="sd">    to the value returned.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        embedder: instance of :class:`.AbstractEmbedder`</span>

<span class="sd">        quantityGenerator: instance of :class:`.AbstractQuantityGenerator`</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">embedder</span><span class="p">,</span> <span class="n">quantityGenerator</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">embedder</span> <span class="o">=</span> <span class="n">embedder</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">quantityGenerator</span> <span class="o">=</span> <span class="n">quantityGenerator</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">RepeatedEmbedder</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_embed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">backgroundStringArr</span><span class="p">,</span> <span class="n">priorEmbeddedThings</span><span class="p">,</span> <span class="n">additionalInfo</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See superclass.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">quantity</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">quantityGenerator</span><span class="o">.</span><span class="n">generateQuantity</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">quantity</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">embedder</span><span class="o">.</span><span class="n">embed</span><span class="p">(</span><span class="n">backgroundStringArr</span><span class="p">,</span>
                                <span class="n">priorEmbeddedThings</span><span class="p">,</span> <span class="n">additionalInfo</span><span class="p">)</span>

<div class="viewcode-block" id="RepeatedEmbedder.getJsonableObject"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.RepeatedEmbedder.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See superclass.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">OrderedDict</span><span class="p">([(</span><span class="s2">&quot;class&quot;</span><span class="p">,</span> <span class="s2">&quot;RepeatedEmbedder&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;embedder&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">embedder</span><span class="o">.</span><span class="n">getJsonableObject</span><span class="p">()),</span> <span class="p">(</span><span class="s2">&quot;quantityGenerator&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">quantityGenerator</span><span class="o">.</span><span class="n">getJsonableObject</span><span class="p">())])</span></div></div>


<div class="viewcode-block" id="AbstractQuantityGenerator"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.AbstractQuantityGenerator">[docs]</a><span class="k">class</span> <span class="nc">AbstractQuantityGenerator</span><span class="p">(</span><span class="n">DefaultNameMixin</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Class for sampling values from a distribution.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="AbstractQuantityGenerator.generateQuantity"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.AbstractQuantityGenerator.generateQuantity">[docs]</a>    <span class="k">def</span> <span class="nf">generateQuantity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sample a quantity from a distribution.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The sampled value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span></div>

<div class="viewcode-block" id="AbstractQuantityGenerator.getJsonableObject"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.AbstractQuantityGenerator.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get JSON object representation.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A json-friendly object (built of dictionaries, lists and</span>
<span class="sd">        python primitives), which can be converted to json to</span>
<span class="sd">        record the exact details of what was simualted.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span></div></div>


<div class="viewcode-block" id="ChooseValueFromASet"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.ChooseValueFromASet">[docs]</a><span class="k">class</span> <span class="nc">ChooseValueFromASet</span><span class="p">(</span><span class="n">AbstractQuantityGenerator</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Randomly samples a particular value from a set of values.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        setOfPossibleValues: array of values that will be randomly sampled</span>
<span class="sd">    from.</span>

<span class="sd">        name: see :class:`.DefaultNameMixin`.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">setOfPossibleValues</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setOfPossibleValues</span> <span class="o">=</span> <span class="n">setOfPossibleValues</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ChooseValueFromASet</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

<div class="viewcode-block" id="ChooseValueFromASet.generateQuantity"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.ChooseValueFromASet.generateQuantity">[docs]</a>    <span class="k">def</span> <span class="nf">generateQuantity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See superclass.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">setOfPossibleValues</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">*</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">setOfPossibleValues</span><span class="p">)))]</span></div>

<div class="viewcode-block" id="ChooseValueFromASet.getJsonableObject"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.ChooseValueFromASet.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See superclass.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">OrderedDict</span><span class="p">([(</span><span class="s2">&quot;class&quot;</span><span class="p">,</span> <span class="s2">&quot;ChooseValueFromASet&quot;</span><span class="p">),</span>
                            <span class="p">(</span><span class="s2">&quot;possibleValues&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">setOfPossibleValues</span><span class="p">)])</span></div></div>


<div class="viewcode-block" id="UniformIntegerGenerator"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.UniformIntegerGenerator">[docs]</a><span class="k">class</span> <span class="nc">UniformIntegerGenerator</span><span class="p">(</span><span class="n">AbstractQuantityGenerator</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Randomly samples an integer from minVal to maxVal, inclusive.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        minVal: minimum integer that can be sampled</span>

<span class="sd">        maxVal: maximum integers that can be sampled</span>
<span class="sd">        </span>
<span class="sd">        name: See superclass.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">minVal</span><span class="p">,</span> <span class="n">maxVal</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">minVal</span> <span class="o">=</span> <span class="n">minVal</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maxVal</span> <span class="o">=</span> <span class="n">maxVal</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">UniformIntegerGenerator</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

<div class="viewcode-block" id="UniformIntegerGenerator.generateQuantity"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.UniformIntegerGenerator.generateQuantity">[docs]</a>    <span class="k">def</span> <span class="nf">generateQuantity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See superclass.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># the 1+ makes the max val inclusive</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">minVal</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxVal</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">minVal</span><span class="p">))</span></div>

<div class="viewcode-block" id="UniformIntegerGenerator.getJsonableObject"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.UniformIntegerGenerator.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See superclass.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">OrderedDict</span><span class="p">([(</span><span class="s2">&quot;class&quot;</span><span class="p">,</span> <span class="s2">&quot;UniformIntegerGenerator&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;minVal&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">minVal</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;maxVal&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxVal</span><span class="p">)])</span></div></div>


<div class="viewcode-block" id="FixedQuantityGenerator"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.FixedQuantityGenerator">[docs]</a><span class="k">class</span> <span class="nc">FixedQuantityGenerator</span><span class="p">(</span><span class="n">AbstractQuantityGenerator</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns a fixed number every time generateQuantity is called.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        quantity: the value to return when generateQuantity is called.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">quantity</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">quantity</span> <span class="o">=</span> <span class="n">quantity</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">FixedQuantityGenerator</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

<div class="viewcode-block" id="FixedQuantityGenerator.generateQuantity"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.FixedQuantityGenerator.generateQuantity">[docs]</a>    <span class="k">def</span> <span class="nf">generateQuantity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See superclass.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">quantity</span></div>

<div class="viewcode-block" id="FixedQuantityGenerator.getJsonableObject"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.FixedQuantityGenerator.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See superclass.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s2">&quot;fixedQuantity-&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">quantity</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="PoissonQuantityGenerator"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.PoissonQuantityGenerator">[docs]</a><span class="k">class</span> <span class="nc">PoissonQuantityGenerator</span><span class="p">(</span><span class="n">AbstractQuantityGenerator</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Generates values according to a poisson distribution.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        mean: the mean of the poisson distribution</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mean</span> <span class="o">=</span> <span class="n">mean</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">PoissonQuantityGenerator</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

<div class="viewcode-block" id="PoissonQuantityGenerator.generateQuantity"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.PoissonQuantityGenerator.generateQuantity">[docs]</a>    <span class="k">def</span> <span class="nf">generateQuantity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See superclass.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">poisson</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">)</span></div>

<div class="viewcode-block" id="PoissonQuantityGenerator.getJsonableObject"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.PoissonQuantityGenerator.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See superclass.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s2">&quot;poisson-&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="BernoulliQuantityGenerator"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.BernoulliQuantityGenerator">[docs]</a><span class="k">class</span> <span class="nc">BernoulliQuantityGenerator</span><span class="p">(</span><span class="n">AbstractQuantityGenerator</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Generates 1 or 0 according to a bernoulli distribution.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        prob: probability of 1</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prob</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prob</span> <span class="o">=</span> <span class="n">prob</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">BernoulliQuantityGenerator</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

<div class="viewcode-block" id="BernoulliQuantityGenerator.generateQuantity"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.BernoulliQuantityGenerator.generateQuantity">[docs]</a>    <span class="k">def</span> <span class="nf">generateQuantity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See superclass.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="mi">1</span> <span class="k">if</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prob</span><span class="p">)</span> <span class="k">else</span> <span class="mi">0</span></div>

<div class="viewcode-block" id="BernoulliQuantityGenerator.getJsonableObject"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.BernoulliQuantityGenerator.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See sueprclass.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s2">&quot;bernoulli-&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">prob</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="MinMaxWrapper"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.MinMaxWrapper">[docs]</a><span class="k">class</span> <span class="nc">MinMaxWrapper</span><span class="p">(</span><span class="n">AbstractQuantityGenerator</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Compress a distribution to lie within a min and a max.</span>

<span class="sd">    Wrapper that restricts a distribution to only return values between</span>
<span class="sd">    the min and the max. If a value outside the range is returned,</span>
<span class="sd">    resamples until it obtains a value within the range.</span>
<span class="sd">    Warns every time it tries to resample 10 times without successfully</span>
<span class="sd">    finding a value in the correct range.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        quantityGenerator: instance of :class:`.AbstractQuantityGenerator`.</span>
<span class="sd">    Used to draw samples from the distribution to truncate</span>

<span class="sd">        theMin: can be None; if so will be ignored.</span>

<span class="sd">        theMax: can be None; if so will be ignored.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">quantityGenerator</span><span class="p">,</span> <span class="n">theMin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">theMax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">quantityGenerator</span> <span class="o">=</span> <span class="n">quantityGenerator</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">theMin</span> <span class="o">=</span> <span class="n">theMin</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">theMax</span> <span class="o">=</span> <span class="n">theMax</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">quantityGenerator</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">MinMaxWrapper</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

<div class="viewcode-block" id="MinMaxWrapper.generateQuantity"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.MinMaxWrapper.generateQuantity">[docs]</a>    <span class="k">def</span> <span class="nf">generateQuantity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See superclass.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tries</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="p">(</span><span class="kc">True</span><span class="p">):</span>
            <span class="n">tries</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">quantity</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">quantityGenerator</span><span class="o">.</span><span class="n">generateQuantity</span><span class="p">()</span>
            <span class="k">if</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">theMin</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">quantity</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">theMin</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">theMax</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">quantity</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">theMax</span><span class="p">)):</span>
                <span class="k">return</span> <span class="n">quantity</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">tries</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;warning: made &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">tries</span><span class="p">)</span> <span class="o">+</span>
                      <span class="s2">&quot; tries at trying to sample from distribution with min/max limits&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="MinMaxWrapper.getJsonableObject"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.MinMaxWrapper.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See superclass.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">OrderedDict</span><span class="p">([(</span><span class="s2">&quot;min&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">theMin</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;max&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">theMax</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;quantityGenerator&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">quantityGenerator</span><span class="o">.</span><span class="n">getJsonableObject</span><span class="p">())])</span></div></div>


<div class="viewcode-block" id="ZeroInflater"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.ZeroInflater">[docs]</a><span class="k">class</span> <span class="nc">ZeroInflater</span><span class="p">(</span><span class="n">AbstractQuantityGenerator</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Inflate a particular distribution with zeros.</span>

<span class="sd">    Wrapper that inflates the number of zeros returned.</span>
<span class="sd">    Flips a coin; if positive, will return zero - otherwise will</span>
<span class="sd">    sample from the wrapped distribution (which may still return 0)</span>

<span class="sd">    Arguments:</span>
<span class="sd">        quantityGenerator: an instance of :class:`.AbstractQuantityGenerator`;\</span>
<span class="sd">    represents the distribution to sample from with probability ``1-zeroProb``</span>

<span class="sd">        zeroProb: the probability of just returning 0 without sampling\</span>
<span class="sd">    from ``quantityGenerator``</span>
<span class="sd">        </span>
<span class="sd">        name: see :class:`.DefaultNameMixin`. </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">quantityGenerator</span><span class="p">,</span> <span class="n">zeroProb</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">quantityGenerator</span> <span class="o">=</span> <span class="n">quantityGenerator</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">zeroProb</span> <span class="o">=</span> <span class="n">zeroProb</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ZeroInflater</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

<div class="viewcode-block" id="ZeroInflater.generateQuantity"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.ZeroInflater.generateQuantity">[docs]</a>    <span class="k">def</span> <span class="nf">generateQuantity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See superclass.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">val</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">zeroProb</span><span class="p">):</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">quantityGenerator</span><span class="o">.</span><span class="n">generateQuantity</span><span class="p">()</span></div>

<div class="viewcode-block" id="ZeroInflater.getJsonableObject"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.ZeroInflater.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See superclass.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">OrderedDict</span><span class="p">([(</span><span class="s2">&quot;class&quot;</span><span class="p">,</span> <span class="s2">&quot;ZeroInflater&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;zeroProb&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">zeroProb</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;quantityGenerator&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">quantityGenerator</span><span class="o">.</span><span class="n">getJsonableObject</span><span class="p">())])</span></div></div>


<div class="viewcode-block" id="SubstringEmbedder"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.SubstringEmbedder">[docs]</a><span class="k">class</span> <span class="nc">SubstringEmbedder</span><span class="p">(</span><span class="n">EmbeddableEmbedder</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Used to embed substrings.</span>

<span class="sd">    Embeds a single generated substring within the background sequence,</span>
<span class="sd">    at a position sampled from a distribution. Only embeds at unoccupied</span>
<span class="sd">    positions</span>

<span class="sd">    Arguments:</span>
<span class="sd">        substringGenerator: instance of :class:`.AbstractSubstringGenerator`</span>

<span class="sd">        positionGenerator: instance of :class:`.AbstractPositionGenerator`</span>

<span class="sd">        name: see :class:`.DefaultNameMixin`.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">substringGenerator</span><span class="p">,</span> <span class="n">positionGenerator</span><span class="o">=</span><span class="n">uniformPositionGenerator</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">SubstringEmbedder</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span>
            <span class="n">SubstringEmbeddableGenerator</span><span class="p">(</span><span class="n">substringGenerator</span><span class="p">),</span> <span class="n">positionGenerator</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span></div>


<div class="viewcode-block" id="sampleIndexWithinRegionOfLength"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.sampleIndexWithinRegionOfLength">[docs]</a><span class="k">def</span> <span class="nf">sampleIndexWithinRegionOfLength</span><span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="n">lengthOfThingToEmbed</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Uniformly at random samples integers from 0 to</span>
<span class="sd">    ``length``-``lengthOfThingToEmbedIn``.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        length: length of full region that could be embedded in</span>

<span class="sd">        lengthOfThingToEmbed: length of thing being embedded in larger region</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="n">lengthOfThingToEmbed</span> <span class="o">&lt;=</span> <span class="n">length</span>
    <span class="n">indexToSample</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span>
        <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">*</span> <span class="p">((</span><span class="n">length</span> <span class="o">-</span> <span class="n">lengthOfThingToEmbed</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">indexToSample</span></div>


<div class="viewcode-block" id="AbstractEmbeddableGenerator"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.AbstractEmbeddableGenerator">[docs]</a><span class="k">class</span> <span class="nc">AbstractEmbeddableGenerator</span><span class="p">(</span><span class="n">DefaultNameMixin</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Generates an embeddable, usually for embedding in a background sequence.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="AbstractEmbeddableGenerator.generateEmbeddable"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.AbstractEmbeddableGenerator.generateEmbeddable">[docs]</a>    <span class="k">def</span> <span class="nf">generateEmbeddable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Generate an embeddable object.</span>

<span class="sd">        Returns:</span>
<span class="sd">            An instance of :class:`AbstractEmbeddable`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span></div>

<div class="viewcode-block" id="AbstractEmbeddableGenerator.getJsonableObject"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.AbstractEmbeddableGenerator.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get JSON object representation.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A json-friendly object (built of dictionaries, lists and</span>
<span class="sd">        python primitives), which can be converted to json to</span>
<span class="sd">        record the exact details of what was simualted.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span></div></div>


<div class="viewcode-block" id="PairEmbeddableGenerator_General"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.PairEmbeddableGenerator_General">[docs]</a><span class="k">class</span> <span class="nc">PairEmbeddableGenerator_General</span><span class="p">(</span><span class="n">AbstractEmbeddableGenerator</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Embed a pair of embeddables with some separation. This class needs</span>
<span class="sd">        to eventually replace :class:`.PairEmbeddableGenerator`</span>
<span class="sd">        </span>
<span class="sd">    Arguments:</span>
<span class="sd">        emeddableGenerator1: instance of</span>
<span class="sd">            :class:`.AbstractEmbeddableGenerator`</span>

<span class="sd">        embeddableGenerator2: instance of</span>
<span class="sd">            :class:`.AbstractEmbeddableGenerator`</span>

<span class="sd">        separationGenerator: instance of</span>
<span class="sd">            :class:`.AbstractQuantityGenerator`</span>

<span class="sd">        name: string, see :class:`DefaultNameMixin`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">embeddableGenerator1</span><span class="p">,</span>
                 <span class="n">embeddableGenerator2</span><span class="p">,</span> <span class="n">separationGenerator</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">embeddableGenerator1</span> <span class="o">=</span> <span class="n">embeddableGenerator1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">embeddableGenerator2</span> <span class="o">=</span> <span class="n">embeddableGenerator2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">separationGenerator</span> <span class="o">=</span> <span class="n">separationGenerator</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">PairEmbeddableGenerator</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

<div class="viewcode-block" id="PairEmbeddableGenerator_General.generateEmbeddable"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.PairEmbeddableGenerator_General.generateEmbeddable">[docs]</a>    <span class="k">def</span> <span class="nf">generateEmbeddable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See superclass.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">embeddable1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">embeddableGenerator1</span><span class="o">.</span><span class="n">generateEmbeddable</span><span class="p">()</span>
        <span class="n">embeddable2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">embeddableGenerator2</span><span class="o">.</span><span class="n">generateEmbeddable</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">PairEmbeddable_General</span><span class="p">(</span>
            <span class="n">embeddable1</span><span class="p">,</span> <span class="n">embeddable2</span><span class="p">,</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">separationGenerator</span><span class="o">.</span><span class="n">generateQuantity</span><span class="p">(</span>
            <span class="p">),</span> <span class="n">embeddable1</span><span class="o">.</span><span class="n">getDescription</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;+&quot;</span> <span class="o">+</span> <span class="n">embeddable2</span><span class="o">.</span><span class="n">getDescription</span><span class="p">()</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="PairEmbeddableGenerator_General.getJsonableObject"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.PairEmbeddableGenerator_General.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See superclass.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">OrderedDict</span><span class="p">([</span>
    <span class="p">(</span><span class="s2">&quot;class&quot;</span><span class="p">,</span> <span class="s2">&quot;PairEmbeddableGenerator&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;embeddableGenerator1&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">embeddableGenerator1</span><span class="o">.</span><span class="n">getJsonableObject</span><span class="p">()),</span>
    <span class="p">(</span><span class="s2">&quot;embeddableenerator2&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">embeddableGenerator2</span><span class="o">.</span><span class="n">getJsonableObject</span><span class="p">()),</span>
    <span class="p">(</span><span class="s2">&quot;separationGenerator&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">separationGenerator</span><span class="o">.</span><span class="n">getJsonableObject</span><span class="p">())])</span></div></div>


<div class="viewcode-block" id="PairEmbeddableGenerator"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.PairEmbeddableGenerator">[docs]</a><span class="k">class</span> <span class="nc">PairEmbeddableGenerator</span><span class="p">(</span><span class="n">AbstractEmbeddableGenerator</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Embed a pair of substrings with some separation. This class needs</span>
<span class="sd">        to be deprecated in favour of just using</span>
<span class="sd">        :class:`.PairEmbeddableGenerator_General`</span>
<span class="sd">        </span>
<span class="sd">    Arguments:</span>
<span class="sd">        substringGenerator1: instance of</span>
<span class="sd">            :class:`.AbstractSubstringGenerator`</span>

<span class="sd">        substringGenerator2: instance of</span>
<span class="sd">            :class:`.AbstractSubstringGenerator`</span>

<span class="sd">        separationGenerator: instance of</span>
<span class="sd">            :class:`.AbstractQuantityGenerator`</span>

<span class="sd">        name: string, see :class:`DefaultNameMixin`</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">substringGenerator1</span><span class="p">,</span> <span class="n">substringGenerator2</span><span class="p">,</span> <span class="n">separationGenerator</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">substringGenerator1</span> <span class="o">=</span> <span class="n">substringGenerator1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">substringGenerator2</span> <span class="o">=</span> <span class="n">substringGenerator2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">separationGenerator</span> <span class="o">=</span> <span class="n">separationGenerator</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">PairEmbeddableGenerator</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

<div class="viewcode-block" id="PairEmbeddableGenerator.generateEmbeddable"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.PairEmbeddableGenerator.generateEmbeddable">[docs]</a>    <span class="k">def</span> <span class="nf">generateEmbeddable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See superclass.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">string1</span><span class="p">,</span> <span class="n">string1Description</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">substringGenerator1</span><span class="o">.</span><span class="n">generateSubstring</span><span class="p">()</span>
        <span class="n">string2</span><span class="p">,</span> <span class="n">string2Description</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">substringGenerator2</span><span class="o">.</span><span class="n">generateSubstring</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">PairEmbeddable</span><span class="p">(</span>
            <span class="n">string1</span><span class="p">,</span> <span class="n">string2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">separationGenerator</span><span class="o">.</span><span class="n">generateQuantity</span><span class="p">(),</span> <span class="n">string1Description</span> <span class="o">+</span>
            <span class="s2">&quot;+&quot;</span> <span class="o">+</span> <span class="n">string2Description</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="PairEmbeddableGenerator.getJsonableObject"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.PairEmbeddableGenerator.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See superclass.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">OrderedDict</span><span class="p">([(</span><span class="s2">&quot;class&quot;</span><span class="p">,</span> <span class="s2">&quot;PairEmbeddableGenerator&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;substringGenerator1&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">substringGenerator1</span><span class="o">.</span><span class="n">getJsonableObject</span><span class="p">()),</span> <span class="p">(</span><span class="s2">&quot;substringGenerator2&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">substringGenerator2</span><span class="o">.</span><span class="n">getJsonableObject</span><span class="p">()),</span> <span class="p">(</span><span class="s2">&quot;separationGenerator&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">separationGenerator</span><span class="o">.</span><span class="n">getJsonableObject</span><span class="p">())</span>
                            <span class="p">])</span></div></div>


<div class="viewcode-block" id="SubstringEmbeddableGenerator"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.SubstringEmbeddableGenerator">[docs]</a><span class="k">class</span> <span class="nc">SubstringEmbeddableGenerator</span><span class="p">(</span><span class="n">AbstractEmbeddableGenerator</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Generates a :class:`.StringEmbeddable`</span>

<span class="sd">    Calls ``substringGenerator``, wraps the result in</span>
<span class="sd">    a :class:`.StringEmbeddable` and returns it.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        substringGenerator: instance of :class:`.AbstractSubstringGenerator`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">substringGenerator</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">substringGenerator</span> <span class="o">=</span> <span class="n">substringGenerator</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">SubstringEmbeddableGenerator</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

<div class="viewcode-block" id="SubstringEmbeddableGenerator.generateEmbeddable"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.SubstringEmbeddableGenerator.generateEmbeddable">[docs]</a>    <span class="k">def</span> <span class="nf">generateEmbeddable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">substring</span><span class="p">,</span> <span class="n">substringDescription</span> <span class="o">=</span>\
            <span class="bp">self</span><span class="o">.</span><span class="n">substringGenerator</span><span class="o">.</span><span class="n">generateSubstring</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">StringEmbeddable</span><span class="p">(</span><span class="n">substring</span><span class="p">,</span> <span class="n">substringDescription</span><span class="p">)</span></div>

<div class="viewcode-block" id="SubstringEmbeddableGenerator.getJsonableObject"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.SubstringEmbeddableGenerator.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See superclass.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">OrderedDict</span><span class="p">([(</span><span class="s2">&quot;class&quot;</span><span class="p">,</span> <span class="s2">&quot;SubstringEmbeddableGenerator&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;substringGenerator&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">substringGenerator</span><span class="o">.</span><span class="n">getJsonableObject</span><span class="p">())])</span></div></div>


<div class="viewcode-block" id="AbstractSubstringGenerator"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.AbstractSubstringGenerator">[docs]</a><span class="k">class</span> <span class="nc">AbstractSubstringGenerator</span><span class="p">(</span><span class="n">DefaultNameMixin</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates a substring, usually for embedding in a background sequence.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="AbstractSubstringGenerator.generateSubstring"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.AbstractSubstringGenerator.generateSubstring">[docs]</a>    <span class="k">def</span> <span class="nf">generateSubstring</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return:</span>
<span class="sd">            A tuple of ``(string, stringDescription)``; the result can be</span>
<span class="sd">        wrapped in an instance of :class:`.StringEmbeddable`.</span>
<span class="sd">        ``stringDescription`` is a short descriptor that does not contain</span>
<span class="sd">        spaces and may be prefixed in front of string when generating</span>
<span class="sd">        the __str__ representation for :class:`.StringEmbeddable`. </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span></div>

<div class="viewcode-block" id="AbstractSubstringGenerator.getJsonableObject"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.AbstractSubstringGenerator.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get JSON object representation.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A json-friendly object (built of dictionaries, lists and</span>
<span class="sd">        python primitives), which can be converted to json to</span>
<span class="sd">        record the exact details of what was simualted.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span></div></div>


<div class="viewcode-block" id="FixedSubstringGenerator"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.FixedSubstringGenerator">[docs]</a><span class="k">class</span> <span class="nc">FixedSubstringGenerator</span><span class="p">(</span><span class="n">AbstractSubstringGenerator</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Generates the same string every time.</span>

<span class="sd">    When generateSubstring() is called, always returns the same string.</span>
<span class="sd">    The string also serves as its own description</span>

<span class="sd">    Arguments:</span>
<span class="sd">        fixedSubstring: the string to be generated</span>

<span class="sd">        name: see :class:`.DefaultNameMixin`</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fixedSubstring</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fixedSubstring</span> <span class="o">=</span> <span class="n">fixedSubstring</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">FixedSubstringGenerator</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

<div class="viewcode-block" id="FixedSubstringGenerator.generateSubstring"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.FixedSubstringGenerator.generateSubstring">[docs]</a>    <span class="k">def</span> <span class="nf">generateSubstring</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See superclass.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fixedSubstring</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fixedSubstring</span></div>

<div class="viewcode-block" id="FixedSubstringGenerator.getJsonableObject"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.FixedSubstringGenerator.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See superclass.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s2">&quot;fixedSubstring-&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">fixedSubstring</span></div></div>


<div class="viewcode-block" id="TransformedSubstringGenerator"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.TransformedSubstringGenerator">[docs]</a><span class="k">class</span> <span class="nc">TransformedSubstringGenerator</span><span class="p">(</span><span class="n">AbstractSubstringGenerator</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Generates a substring and applies a series of transformations.</span>

<span class="sd">    Takes a substringGenerator and a set of AbstractTransformation objects,</span>
<span class="sd">    applies the transformations to the generated substring</span>

<span class="sd">    Arguments:</span>
<span class="sd">        substringGenerator: instance of :class:`.AbstractSubstringGenerator`</span>

<span class="sd">        transformations: an iterable of :class:`.AbstractTransformation`</span>

<span class="sd">        transformationsDescription: a string that will be prefixed in\</span>
<span class="sd">        front of ``substringDescription`` (generated by\</span>
<span class="sd">        ``substringGenerator.generateSubstring())`` to produce the\</span>
<span class="sd">        ``stringDescription``.</span>

<span class="sd">        name: see :class:`.DefaultNameMixin`.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">substringGenerator</span><span class="p">,</span> <span class="n">transformations</span><span class="p">,</span>
                       <span class="n">transformationsDescription</span><span class="o">=</span><span class="s2">&quot;transformations&quot;</span><span class="p">,</span>
                       <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">substringGenerator</span> <span class="o">=</span> <span class="n">substringGenerator</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transformations</span> <span class="o">=</span> <span class="n">transformations</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transformationsDescription</span> <span class="o">=</span> <span class="n">transformationsDescription</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">TransformedSubstringGenerator</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

<div class="viewcode-block" id="TransformedSubstringGenerator.generateSubstring"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.TransformedSubstringGenerator.generateSubstring">[docs]</a>    <span class="k">def</span> <span class="nf">generateSubstring</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See superclass.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">substring</span><span class="p">,</span> <span class="n">substringDescription</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">substringGenerator</span><span class="o">.</span><span class="n">generateSubstring</span><span class="p">()</span>
        <span class="n">baseSubstringArr</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">substring</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">transformation</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformations</span><span class="p">:</span>
            <span class="n">baseSubstringArr</span> <span class="o">=</span> <span class="n">transformation</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">baseSubstringArr</span><span class="p">)</span>
        <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">baseSubstringArr</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformationsDescription</span> <span class="o">+</span> <span class="s2">&quot;-&quot;</span> <span class="o">+</span> <span class="n">substringDescription</span></div>

<div class="viewcode-block" id="TransformedSubstringGenerator.getJsonableObject"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.TransformedSubstringGenerator.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See superclass.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">OrderedDict</span><span class="p">([(</span><span class="s2">&quot;class&quot;</span><span class="p">,</span> <span class="s2">&quot;TransformedSubstringGenerator&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;substringGenerator&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">substringGenerator</span><span class="o">.</span><span class="n">getJsonableObject</span><span class="p">()),</span>
    <span class="p">(</span><span class="s2">&quot;transformations&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">getJsonableObject</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformations</span><span class="p">])</span>
    <span class="p">])</span></div></div>


<div class="viewcode-block" id="AbstractTransformation"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.AbstractTransformation">[docs]</a><span class="k">class</span> <span class="nc">AbstractTransformation</span><span class="p">(</span><span class="n">DefaultNameMixin</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Class representing a transformation applied to a character array.</span>

<span class="sd">    Takes an array of characters, applies some transformation.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="AbstractTransformation.transform"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.AbstractTransformation.transform">[docs]</a>    <span class="k">def</span> <span class="nf">transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stringArr</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Applies a transformation to stringArr.</span>

<span class="sd">            Arguments:</span>
<span class="sd">                stringArr: an array of characters.</span>

<span class="sd">            Returns:</span>
<span class="sd">                An array of characters that has the transformation applied.</span>
<span class="sd">            May mutate ``stringArr``</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span></div>

<div class="viewcode-block" id="AbstractTransformation.getJsonableObject"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.AbstractTransformation.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get JSON object representation.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A json-friendly object (built of dictionaries, lists and</span>
<span class="sd">        python primitives), which can be converted to json to</span>
<span class="sd">        record the exact details of what was simualted.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span></div></div>


<div class="viewcode-block" id="RevertToReference"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.RevertToReference">[docs]</a><span class="k">class</span> <span class="nc">RevertToReference</span><span class="p">(</span><span class="n">AbstractTransformation</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;For a series of mutations, reverts the supplied character</span>
<span class="sd">    to the reference (&quot;unmutated&quot;) string.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        setOfMutations: instance of AbstractSetOfMutations</span>

<span class="sd">        name: see :class:`.DefaultNameMixin`.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">setOfMutations</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setOfMutations</span> <span class="o">=</span> <span class="n">setOfMutations</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">RevertToReference</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

<div class="viewcode-block" id="RevertToReference.transform"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.RevertToReference.transform">[docs]</a>    <span class="k">def</span> <span class="nf">transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stringArr</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See superclass.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">mutation</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">setOfMutations</span><span class="o">.</span><span class="n">getMutationsArr</span><span class="p">():</span>
            <span class="n">mutation</span><span class="o">.</span><span class="n">revert</span><span class="p">(</span><span class="n">stringArr</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">stringArr</span></div>

<div class="viewcode-block" id="RevertToReference.getJsonableObject"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.RevertToReference.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See superclass.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">OrderedDict</span><span class="p">([</span>
                 <span class="p">(</span><span class="s2">&quot;class&quot;</span><span class="p">,</span> <span class="s2">&quot;RevertToReference&quot;</span><span class="p">),</span>
                 <span class="p">(</span><span class="s2">&quot;setOfMutations&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">setOfMutations</span><span class="o">.</span><span class="n">getJsonableObject</span><span class="p">())])</span></div></div>


<div class="viewcode-block" id="AbstractApplySingleMutationFromSet"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.AbstractApplySingleMutationFromSet">[docs]</a><span class="k">class</span> <span class="nc">AbstractApplySingleMutationFromSet</span><span class="p">(</span><span class="n">AbstractTransformation</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Class for applying a single mutation from a set of mutations; used</span>
<span class="sd">        to transform substrings generated by another method</span>

<span class="sd">        Arguments:</span>
<span class="sd">            setOfMutations: instance of :class:`.AbstractSetOfMutations`</span>

<span class="sd">            name: see :class:`.DefaultNameMixin`.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">setOfMutations</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setOfMutations</span> <span class="o">=</span> <span class="n">setOfMutations</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">AbstractApplySingleMutationFromSet</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

<div class="viewcode-block" id="AbstractApplySingleMutationFromSet.transform"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.AbstractApplySingleMutationFromSet.transform">[docs]</a>    <span class="k">def</span> <span class="nf">transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stringArr</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See superclass.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">selectedMutation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">selectMutation</span><span class="p">()</span>
        <span class="n">selectedMutation</span><span class="o">.</span><span class="n">applyMutation</span><span class="p">(</span><span class="n">stringArr</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">stringArr</span></div>

<div class="viewcode-block" id="AbstractApplySingleMutationFromSet.selectMutation"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.AbstractApplySingleMutationFromSet.selectMutation">[docs]</a>    <span class="k">def</span> <span class="nf">selectMutation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Chooses a mutation from the set of mutations to apply.</span>

<span class="sd">        Returns:</span>
<span class="sd">            an instance of :class:`.Mutation`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span></div>

<div class="viewcode-block" id="AbstractApplySingleMutationFromSet.getJsonableObject"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.AbstractApplySingleMutationFromSet.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See superclass.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">OrderedDict</span><span class="p">([</span>
    <span class="p">(</span><span class="s2">&quot;class&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__name__</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;selectedMutations&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">setOfMutations</span><span class="o">.</span><span class="n">getJsonableObject</span><span class="p">())])</span></div></div>


<div class="viewcode-block" id="Mutation"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.Mutation">[docs]</a><span class="k">class</span> <span class="nc">Mutation</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Represent a single bp mutation in a motif sequence.</span>

<span class="sd">    Useful for creating simulations involving SNPs.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        index: the position idx within the motif of the mutation</span>

<span class="sd">        previous: character, the previous base at this position</span>

<span class="sd">        new: character, the new base at this position after the mutation</span>

<span class="sd">        parentLength: optional; length of the motif. Used for assertion checks.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">previous</span><span class="p">,</span> <span class="n">new</span><span class="p">,</span> <span class="n">parentLength</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">index</span>
        <span class="k">assert</span> <span class="n">previous</span> <span class="o">!=</span> <span class="n">new</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">previous</span> <span class="o">=</span> <span class="n">previous</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">new</span> <span class="o">=</span> <span class="n">new</span>
        <span class="c1"># the length of the full sequence that self.index indexes into</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parentLength</span> <span class="o">=</span> <span class="n">parentLength</span>

<div class="viewcode-block" id="Mutation.parentLengthAssertionCheck"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.Mutation.parentLengthAssertionCheck">[docs]</a>    <span class="k">def</span> <span class="nf">parentLengthAssertionCheck</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stringArr</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Checks that stringArr is consistent with parentLength if defined.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentLength</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">stringArr</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentLength</span></div>

<div class="viewcode-block" id="Mutation.revert"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.Mutation.revert">[docs]</a>    <span class="k">def</span> <span class="nf">revert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stringArr</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the base at the position of the mutation to the unmutated value.</span>

<span class="sd">        Modifies stringArr which is an array of characters.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            stringArr: an array of characters, which gets modified.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parentLengthAssertionCheck</span><span class="p">(</span><span class="n">stringArr</span><span class="p">)</span>
        <span class="n">stringArr</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">previous</span></div>

<div class="viewcode-block" id="Mutation.applyMutation"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.Mutation.applyMutation">[docs]</a>    <span class="k">def</span> <span class="nf">applyMutation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stringArr</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the base at the position of the mutation to the mutated value.</span>
<span class="sd">        </span>
<span class="sd">        Modifies stringArr which is an array of characters.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            stringArr: an array of characters, which gets modified.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parentLengthAssertionCheck</span><span class="p">(</span><span class="n">stringArr</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">stringArr</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">previous</span>
        <span class="n">stringArr</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">new</span></div></div>

<div class="viewcode-block" id="ChooseMutationAtRandom"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.ChooseMutationAtRandom">[docs]</a><span class="k">class</span> <span class="nc">ChooseMutationAtRandom</span><span class="p">(</span><span class="n">AbstractApplySingleMutationFromSet</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Selects a mutation at random from self.setOfMutations to apply.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="ChooseMutationAtRandom.selectMutation"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.ChooseMutationAtRandom.selectMutation">[docs]</a>    <span class="k">def</span> <span class="nf">selectMutation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">mutationsArr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">setOfMutations</span><span class="o">.</span><span class="n">getMutationsArr</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">mutationsArr</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">mutationsArr</span><span class="p">))]</span></div></div>


<div class="viewcode-block" id="AbstractSetOfMutations"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.AbstractSetOfMutations">[docs]</a><span class="k">class</span> <span class="nc">AbstractSetOfMutations</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Represents a collection of :class:`.Mutation` objects.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        mutationsArr: array of :class:`.Mutation` objects</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mutationsArr</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mutationsArr</span> <span class="o">=</span> <span class="n">mutationsArr</span>

<div class="viewcode-block" id="AbstractSetOfMutations.getMutationsArr"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.AbstractSetOfMutations.getMutationsArr">[docs]</a>    <span class="k">def</span> <span class="nf">getMutationsArr</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns ``self.mutationsArr``</span>

<span class="sd">        Returns:</span>
<span class="sd">            ``self.mutationsArr``</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mutationsArr</span></div>

<div class="viewcode-block" id="AbstractSetOfMutations.getJsonableObject"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.AbstractSetOfMutations.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get JSON object representation.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A json-friendly object (built of dictionaries, lists and</span>
<span class="sd">        python primitives), which can be converted to json to</span>
<span class="sd">        record the exact details of what was simualted.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span></div></div>


<div class="viewcode-block" id="ReverseComplementWrapper"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.ReverseComplementWrapper">[docs]</a><span class="k">class</span> <span class="nc">ReverseComplementWrapper</span><span class="p">(</span><span class="n">AbstractSubstringGenerator</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Reverse complements a string with a specified probability.</span>

<span class="sd">    Wrapper around an instance of</span>
<span class="sd">    :class:`.AbstractSubstringGenerator` that reverse complements the</span>
<span class="sd">    generated string with a specified probability.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        substringGenerator: instance of `.AbstractSubstringGenerator`</span>

<span class="sd">        reverseComplementProb: probability of reverse complementation.</span>
<span class="sd">    Defaults to 0.5.</span>

<span class="sd">        name: see :class:`.DefaultNameMixin`.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">substringGenerator</span><span class="p">,</span> <span class="n">reverseComplementProb</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reverseComplementProb</span> <span class="o">=</span> <span class="n">reverseComplementProb</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">substringGenerator</span> <span class="o">=</span> <span class="n">substringGenerator</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ReverseComplementWrapper</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

<div class="viewcode-block" id="ReverseComplementWrapper.generateSubstring"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.ReverseComplementWrapper.generateSubstring">[docs]</a>    <span class="k">def</span> <span class="nf">generateSubstring</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">seq</span><span class="p">,</span> <span class="n">seqDescription</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">substringGenerator</span><span class="o">.</span><span class="n">generateSubstring</span><span class="p">()</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">reverseComplementProb</span><span class="p">):</span>
            <span class="n">seq</span> <span class="o">=</span> <span class="n">util</span><span class="o">.</span><span class="n">reverseComplement</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span>
            <span class="n">seqDescription</span> <span class="o">=</span> <span class="s2">&quot;revComp-&quot;</span> <span class="o">+</span> <span class="n">seqDescription</span>
        <span class="k">return</span> <span class="n">seq</span><span class="p">,</span> <span class="n">seqDescription</span></div>

<div class="viewcode-block" id="ReverseComplementWrapper.getJsonableObject"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.ReverseComplementWrapper.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See superclass.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">OrderedDict</span><span class="p">([</span>
    <span class="p">(</span><span class="s2">&quot;class&quot;</span><span class="p">,</span> <span class="s2">&quot;ReverseComplementWrapper&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;reverseComplementProb&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">reverseComplementProb</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;substringGenerator&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">substringGenerator</span><span class="o">.</span><span class="n">getJsonableObject</span><span class="p">())])</span></div></div>


<div class="viewcode-block" id="PwmSampler"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.PwmSampler">[docs]</a><span class="k">class</span> <span class="nc">PwmSampler</span><span class="p">(</span><span class="n">AbstractSubstringGenerator</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Samples from a pwm by calling ``self.pwm.sampleFromPwm``</span>

<span class="sd">    Arguments:</span>
<span class="sd">        pwm: an instance of ``pwm.PWM``</span>

<span class="sd">        name: see :class:`.DefaultNameMixin`</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pwm</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pwm</span> <span class="o">=</span> <span class="n">pwm</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">PwmSampler</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

<div class="viewcode-block" id="PwmSampler.generateSubstring"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.PwmSampler.generateSubstring">[docs]</a>    <span class="k">def</span> <span class="nf">generateSubstring</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See superclass.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pwm</span><span class="o">.</span><span class="n">sampleFromPwm</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">pwm</span><span class="o">.</span><span class="n">name</span></div>

<div class="viewcode-block" id="PwmSampler.getJsonableObject"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.PwmSampler.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See superclass.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">OrderedDict</span><span class="p">([(</span><span class="s2">&quot;class&quot;</span><span class="p">,</span> <span class="s2">&quot;PwmSampler&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;motifName&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pwm</span><span class="o">.</span><span class="n">name</span><span class="p">)])</span></div></div>


<div class="viewcode-block" id="PwmSamplerFromLoadedMotifs"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.PwmSamplerFromLoadedMotifs">[docs]</a><span class="k">class</span> <span class="nc">PwmSamplerFromLoadedMotifs</span><span class="p">(</span><span class="n">PwmSampler</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Instantiates a :class:`.PwmSampler` from a</span>
<span class="sd">    :class:`.LoadedEncodeMotifs` file.</span>

<span class="sd">    Convenience wrapper class for instantiating :class:`.PwmSampler`</span>
<span class="sd">    by pulling the pwm.PWM object using the provided name</span>
<span class="sd">    from an :class:`.AbstractLoadedMotifs` object</span>

<span class="sd">    Arguments:</span>
<span class="sd">        loadedMotifs: instance of :class:`.AbstractLoadedMotifs` </span>

<span class="sd">        motifName: string, name of a motif in :class:`.AbstractLoadedMotifs`</span>

<span class="sd">        name: see :class:`.DefaultNameMixin`</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loadedMotifs</span><span class="p">,</span> <span class="n">motifName</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loadedMotifs</span> <span class="o">=</span> <span class="n">loadedMotifs</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">PwmSamplerFromLoadedMotifs</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span>
            <span class="n">loadedMotifs</span><span class="o">.</span><span class="n">getPwm</span><span class="p">(</span><span class="n">motifName</span><span class="p">),</span> <span class="n">name</span><span class="p">)</span>

<div class="viewcode-block" id="PwmSamplerFromLoadedMotifs.getJsonableObject"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.PwmSamplerFromLoadedMotifs.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See superclass.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">PwmSamplerFromLoadedMotifs</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">getJsonableObject</span><span class="p">()</span>
        <span class="n">obj</span><span class="p">[</span><span class="s1">&#39;loadedMotifs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loadedMotifs</span><span class="o">.</span><span class="n">getJsonableObject</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">obj</span></div></div>


<div class="viewcode-block" id="BestHitPwm"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.BestHitPwm">[docs]</a><span class="k">class</span> <span class="nc">BestHitPwm</span><span class="p">(</span><span class="n">AbstractSubstringGenerator</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Always return the best possible match to a ``pwm.PWM`` when called.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        pwm: an instance of ``pwm.PWM``</span>

<span class="sd">        bestHitMode: one of the values in ``pwm.BEST_HIT_MODE``. If ``pwmProb``</span>
<span class="sd">    then the best match will be determined according what is most likely</span>
<span class="sd">    to be sampled from the pwm matrix (this is the default). If</span>
<span class="sd">    ``logOdds``, then the best match will be determined according to what</span>
<span class="sd">    would result in the best match according to the log-odds matrix</span>
<span class="sd">    (so, taking the background into account).</span>

<span class="sd">        name: see :class:`.DefaultNameMixin`</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pwm</span><span class="p">,</span> <span class="n">bestHitMode</span><span class="o">=</span><span class="n">pwm</span><span class="o">.</span><span class="n">BEST_HIT_MODE</span><span class="o">.</span><span class="n">pwmProb</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pwm</span> <span class="o">=</span> <span class="n">pwm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bestHitMode</span> <span class="o">=</span> <span class="n">bestHitMode</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">BestHitPwm</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

<div class="viewcode-block" id="BestHitPwm.generateSubstring"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.BestHitPwm.generateSubstring">[docs]</a>    <span class="k">def</span> <span class="nf">generateSubstring</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See superclass.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pwm</span><span class="o">.</span><span class="n">getBestHit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bestHitMode</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">pwm</span><span class="o">.</span><span class="n">name</span></div>

<div class="viewcode-block" id="BestHitPwm.getJsonableObject"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.BestHitPwm.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See superclass.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">OrderedDict</span><span class="p">([(</span><span class="s2">&quot;class&quot;</span><span class="p">,</span> <span class="s2">&quot;BestHitPwm&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;pwm&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pwm</span><span class="o">.</span><span class="n">name</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;bestHitMode&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bestHitMode</span><span class="p">)])</span></div></div>


<div class="viewcode-block" id="BestHitPwmFromLoadedMotifs"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.BestHitPwmFromLoadedMotifs">[docs]</a><span class="k">class</span> <span class="nc">BestHitPwmFromLoadedMotifs</span><span class="p">(</span><span class="n">BestHitPwm</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Instantiates :class:`BestHitPwm` using a :class:`.LoadedMotifs` file.</span>
<span class="sd">    Analogous to :class:`.PwmSamplerFromLoadedMotifs`.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loadedMotifs</span><span class="p">,</span> <span class="n">motifName</span><span class="p">,</span>
                 <span class="n">bestHitMode</span><span class="o">=</span><span class="n">pwm</span><span class="o">.</span><span class="n">BEST_HIT_MODE</span><span class="o">.</span><span class="n">pwmProb</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loadedMotifs</span> <span class="o">=</span> <span class="n">loadedMotifs</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">BestHitPwmFromLoadedMotifs</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span>
            <span class="n">loadedMotifs</span><span class="o">.</span><span class="n">getPwm</span><span class="p">(</span><span class="n">motifName</span><span class="p">),</span> <span class="n">bestHitMode</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>

<div class="viewcode-block" id="BestHitPwmFromLoadedMotifs.getJsonableObject"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.BestHitPwmFromLoadedMotifs.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See superclass.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">BestHitPwmFromLoadedMotifs</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">getJsonableObject</span><span class="p">()</span>
        <span class="n">obj</span><span class="p">[</span><span class="s1">&#39;loadedMotifs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loadedMotifs</span><span class="o">.</span><span class="n">getJsonableObject</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">obj</span></div></div>


<div class="viewcode-block" id="AbstractLoadedMotifs"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.AbstractLoadedMotifs">[docs]</a><span class="k">class</span> <span class="nc">AbstractLoadedMotifs</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Class representing loaded PWMs.</span>

<span class="sd">    A class that contains instances of ``pwm.PWM`` loaded from a file.</span>
<span class="sd">    The pwms can be accessed by name.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        fileName: string, the path to the file to load</span>

<span class="sd">        pseudocountProb: if some of the pwms have 0 probability for\</span>
<span class="sd">    some of the positions, will add the specified ``pseudocountProb``\</span>
<span class="sd">    to the rows of the pwm and renormalise.</span>

<span class="sd">        background: a dictionary with ACGT as the keys and the frequency as\</span>
<span class="sd">    the values. Defaults to ``util.DEFAULT_BACKGROUND_FREQ``</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fileName</span><span class="p">,</span>
                       <span class="n">pseudocountProb</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                       <span class="n">background</span><span class="o">=</span><span class="n">util</span><span class="o">.</span><span class="n">DEFAULT_BACKGROUND_FREQ</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fileName</span> <span class="o">=</span> <span class="n">fileName</span>
        <span class="n">fileHandle</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">getFileHandle</span><span class="p">(</span><span class="n">fileName</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pseudocountProb</span> <span class="o">=</span> <span class="n">pseudocountProb</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">background</span> <span class="o">=</span> <span class="n">background</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">recordedPwms</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="n">action</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getReadPwmAction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">recordedPwms</span><span class="p">)</span>
        <span class="n">fp</span><span class="o">.</span><span class="n">performActionOnEachLineOfFile</span><span class="p">(</span>
            <span class="n">fileHandle</span><span class="o">=</span><span class="n">fileHandle</span><span class="p">,</span> <span class="n">transformation</span><span class="o">=</span><span class="n">fp</span><span class="o">.</span><span class="n">trimNewline</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="n">action</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">pwm</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">recordedPwms</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">pwm</span><span class="o">.</span><span class="n">finalise</span><span class="p">(</span><span class="n">pseudocountProb</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pseudocountProb</span><span class="p">)</span>

<div class="viewcode-block" id="AbstractLoadedMotifs.getPwm"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.AbstractLoadedMotifs.getPwm">[docs]</a>    <span class="k">def</span> <span class="nf">getPwm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get a specific PWM.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The ``pwm.PWM`` instance with the specified name.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">recordedPwms</span><span class="p">[</span><span class="n">name</span><span class="p">]</span></div>

<div class="viewcode-block" id="AbstractLoadedMotifs.getReadPwmAction"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.AbstractLoadedMotifs.getReadPwmAction">[docs]</a>    <span class="k">def</span> <span class="nf">getReadPwmAction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">recordedPwms</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Action performed when each line of the pwm text file is read in.</span>

<span class="sd">        This function is to be overridden by a specific implementation.</span>
<span class="sd">        It is executed on each line of the file when it is read in, and</span>
<span class="sd">        when PWMs are ready they will get inserted into ``recordedPwms``.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            recordedPwms: an ``OrderedDict`` that will be filled with PWMs.</span>
<span class="sd">        The keys will be the names of the PWMs and the</span>
<span class="sd">        values will be instances of ``pwm.PWM``</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span></div>

<div class="viewcode-block" id="AbstractLoadedMotifs.getJsonableObject"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.AbstractLoadedMotifs.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get JSON object representation.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A json-friendly object (built of dictionaries, lists and</span>
<span class="sd">        python primitives), which can be converted to json to</span>
<span class="sd">        record the exact details of what was simualted.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">OrderedDict</span><span class="p">([</span>
    <span class="p">(</span><span class="s2">&quot;fileName&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fileName</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;pseudocountProb&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pseudocountProb</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;background&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">background</span><span class="p">)])</span></div></div>


<div class="viewcode-block" id="LoadedEncodeMotifs"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.LoadedEncodeMotifs">[docs]</a><span class="k">class</span> <span class="nc">LoadedEncodeMotifs</span><span class="p">(</span><span class="n">AbstractLoadedMotifs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A class for reading in a motifs file in the ENCODE motifs format.</span>

<span class="sd">    This class is specifically for reading files in the encode motif</span>
<span class="sd">    format - specifically the motifs.txt file that contains Pouya&#39;s motifs</span>
<span class="sd">    (http://compbio.mit.edu/encode-motifs/motifs.txt)</span>

<span class="sd">    Basically, the motif declarations start with a &gt;, the first</span>
<span class="sd">    characters after &gt; until the first space are taken as the motif name,</span>
<span class="sd">    the lines after the line with a &gt; have the format:</span>
<span class="sd">    &quot;&lt;ignored character&gt; &lt;prob of A&gt; &lt;prob of C&gt; &lt;prob of G&gt; &lt;prob of T&gt;&quot;</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="LoadedEncodeMotifs.getReadPwmAction"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.LoadedEncodeMotifs.getReadPwmAction">[docs]</a>    <span class="k">def</span> <span class="nf">getReadPwmAction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">recordedPwms</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See superclass.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">currentPwm</span> <span class="o">=</span> <span class="n">util</span><span class="o">.</span><span class="n">VariableWrapper</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">action</span><span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="n">lineNumber</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">inp</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;&gt;&quot;</span><span class="p">)):</span>
                <span class="n">inp</span> <span class="o">=</span> <span class="n">inp</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(</span><span class="s2">&quot;&gt;&quot;</span><span class="p">)</span>
                <span class="n">inpArr</span> <span class="o">=</span> <span class="n">inp</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                <span class="n">motifName</span> <span class="o">=</span> <span class="n">inpArr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">currentPwm</span><span class="o">.</span><span class="n">var</span> <span class="o">=</span> <span class="n">pwm</span><span class="o">.</span><span class="n">PWM</span><span class="p">(</span><span class="n">motifName</span><span class="p">,</span> <span class="n">background</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">background</span><span class="p">)</span>
                <span class="n">recordedPwms</span><span class="p">[</span><span class="n">currentPwm</span><span class="o">.</span><span class="n">var</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">currentPwm</span><span class="o">.</span><span class="n">var</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># assume that it&#39;s a line of the pwm</span>
                <span class="k">assert</span> <span class="n">currentPwm</span><span class="o">.</span><span class="n">var</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                <span class="n">inpArr</span> <span class="o">=</span> <span class="n">inp</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                <span class="n">summaryLetter</span> <span class="o">=</span> <span class="n">inpArr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">currentPwm</span><span class="o">.</span><span class="n">var</span><span class="o">.</span><span class="n">addRow</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">inpArr</span><span class="p">[</span><span class="mi">1</span><span class="p">:]])</span>
        <span class="k">return</span> <span class="n">action</span></div></div>


<div class="viewcode-block" id="AbstractBackgroundGenerator"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.AbstractBackgroundGenerator">[docs]</a><span class="k">class</span> <span class="nc">AbstractBackgroundGenerator</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns the sequence that :class:`.AbstractEmbeddable` objects</span>
<span class="sd">    are to be embedded into.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="AbstractBackgroundGenerator.generateBackground"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.AbstractBackgroundGenerator.generateBackground">[docs]</a>    <span class="k">def</span> <span class="nf">generateBackground</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a sequence that is the background.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span></div>

<div class="viewcode-block" id="AbstractBackgroundGenerator.getJsonableObject"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.AbstractBackgroundGenerator.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get JSON object representation.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A json-friendly object (built of dictionaries, lists and</span>
<span class="sd">        python primitives), which can be converted to json to</span>
<span class="sd">        record the exact details of what was simualted.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span></div></div>


<div class="viewcode-block" id="RepeatedSubstringBackgroundGenerator"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.RepeatedSubstringBackgroundGenerator">[docs]</a><span class="k">class</span> <span class="nc">RepeatedSubstringBackgroundGenerator</span><span class="p">(</span><span class="n">AbstractBackgroundGenerator</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Repeatedly call a substring generator and concatenate the result.</span>

<span class="sd">    Can be used to generate variable-length sequences.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        substringGenerator: instance of :class:`.AbstractSubstringGenerator`</span>

<span class="sd">        repetitions: instance of :class:`.AbstractQuantityGenerator`.\</span>
<span class="sd">        If pass an int, will create a\</span>
<span class="sd">        :class:`.FixedQuantityGenerator` from the int. This will be called\</span>
<span class="sd">        to determine the number of times to generate a substring from\</span>
<span class="sd">        ``self.substringGenerator``</span>

<span class="sd">    Returns:</span>
<span class="sd">        The concatenation of all the calls to ``self.substringGenerator``</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">substringGenerator</span><span class="p">,</span> <span class="n">repetitions</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">substringGenerator</span> <span class="o">=</span> <span class="n">substringGenerator</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">repetitions</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">repetitions</span> <span class="o">=</span> <span class="n">FixedQuantityGenerator</span><span class="p">(</span><span class="n">repetitions</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">repetitions</span><span class="p">,</span> <span class="n">AbstractQuantityGenerator</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">repetitions</span> <span class="o">=</span> <span class="n">repetitions</span>

<div class="viewcode-block" id="RepeatedSubstringBackgroundGenerator.generateBackground"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.RepeatedSubstringBackgroundGenerator.generateBackground">[docs]</a>    <span class="k">def</span> <span class="nf">generateBackground</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">toReturn</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">repetitions</span><span class="o">.</span><span class="n">generateQuantity</span><span class="p">()):</span>
            <span class="c1"># first pos is substring, second pos is the name</span>
            <span class="n">toReturn</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">substringGenerator</span><span class="o">.</span><span class="n">generateSubstring</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">toReturn</span><span class="p">)</span></div>

<div class="viewcode-block" id="RepeatedSubstringBackgroundGenerator.getJsonableObject"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.RepeatedSubstringBackgroundGenerator.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See superclass.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">OrderedDict</span><span class="p">([</span>
    <span class="p">(</span><span class="s2">&quot;class&quot;</span><span class="p">,</span> <span class="s2">&quot;RepeatedSubstringBackgroundGenerator&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;substringGenerator&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">substringGenerator</span><span class="o">.</span><span class="n">getJsonableObject</span><span class="p">()),</span>
    <span class="p">(</span><span class="s2">&quot;repetitions&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">repetitions</span><span class="o">.</span><span class="n">getJsonableObject</span><span class="p">())])</span></div></div>


<div class="viewcode-block" id="SampleFromDiscreteDistributionSubstringGenerator"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.SampleFromDiscreteDistributionSubstringGenerator">[docs]</a><span class="k">class</span> <span class="nc">SampleFromDiscreteDistributionSubstringGenerator</span><span class="p">(</span><span class="n">AbstractSubstringGenerator</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Generate a substring by sampling from a distribution.</span>

<span class="sd">    If the &quot;substrings&quot; are single characters (A/C/G/T), can be used</span>
<span class="sd">    in conjunction with :class:`.RepeatedSubstringBackgroundGenerator` to</span>
<span class="sd">    generate sequences with a certain GC content.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        discreteDistribution: instance of ``util.DiscreteDistribution``</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">discreteDistribution</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">discreteDistribution</span> <span class="o">=</span> <span class="n">discreteDistribution</span>

<div class="viewcode-block" id="SampleFromDiscreteDistributionSubstringGenerator.generateSubstring"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.SampleFromDiscreteDistributionSubstringGenerator.generateSubstring">[docs]</a>    <span class="k">def</span> <span class="nf">generateSubstring</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">discreteDistribution</span><span class="o">.</span><span class="n">sample</span><span class="p">()</span></div>

<div class="viewcode-block" id="SampleFromDiscreteDistributionSubstringGenerator.getJsonableObject"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.SampleFromDiscreteDistributionSubstringGenerator.getJsonableObject">[docs]</a>    <span class="k">def</span> <span class="nf">getJsonableObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See superclass.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">OrderedDict</span><span class="p">([</span>
    <span class="p">(</span><span class="s2">&quot;class&quot;</span><span class="p">,</span> <span class="s2">&quot;SampleFromDiscreteDistributionSubstringGenerator&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;discreteDistribution&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">discreteDistribution</span><span class="o">.</span><span class="n">valToFreq</span><span class="p">)])</span></div></div>


<div class="viewcode-block" id="ZeroOrderBackgroundGenerator"><a class="viewcode-back" href="../../synthetic.html#simdna.synthetic.ZeroOrderBackgroundGenerator">[docs]</a><span class="k">class</span> <span class="nc">ZeroOrderBackgroundGenerator</span><span class="p">(</span><span class="n">RepeatedSubstringBackgroundGenerator</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns a sequence with a certain GC content.</span>

<span class="sd">    Each base is sampled independently.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        seqLength: int, length of the background </span>

<span class="sd">        discreteDistribution: instance of ``util.DiscreteDistribution`,\</span>
<span class="sd">    defaults to ``util.DEFAULT_BASE_DISCRETE_DISTRIBUTION``</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seqLength</span><span class="p">,</span> <span class="n">discreteDistribution</span><span class="o">=</span><span class="n">util</span><span class="o">.</span><span class="n">DEFAULT_BASE_DISCRETE_DISTRIBUTION</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ZeroOrderBackgroundGenerator</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span>
    <span class="n">SampleFromDiscreteDistributionSubstringGenerator</span><span class="p">(</span><span class="n">discreteDistribution</span><span class="p">),</span>
    <span class="n">seqLength</span><span class="p">)</span></div>

</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2016, Avanti Shrikumar, Johnny Israeli.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.4.5</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.9</a>
      
    </div>

    

    
  </body>
</html>